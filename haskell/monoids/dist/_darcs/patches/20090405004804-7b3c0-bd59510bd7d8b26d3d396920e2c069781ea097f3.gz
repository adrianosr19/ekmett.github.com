[auto
ekmett@gmail.com**20090405004804
 Ignore-this: d5b5a21abb494e96a14b029b1b644182
] {
hunk ./doc/html/monoids/Data-Generator.html 774
+><A HREF="/usr/local/share/doc/ghc/libraries/base/Prelude.html#t%3AEnum"
+>Enum</A
+> a =&gt; <A HREF="Data-Generator.html#t%3AGenerator"
+>Generator</A
+> (<A HREF="Data-Ring-Semi-BitSet.html#t%3ABitSet"
+>BitSet</A
+> a)</TD
+></TR
+><TR
+><TD CLASS="decl"
hunk ./doc/html/monoids/Data-Ring-Semi-BitSet.html 461
->(<A HREF="/usr/local/share/doc/ghc/libraries/base/Prelude.html#t%3AEnum"
->Enum</A
-> a, <A HREF="/usr/local/share/doc/ghc/libraries/base/Text-Show.html#t%3AShow"
->Show</A
-> a) =&gt; <A HREF="/usr/local/share/doc/ghc/libraries/base/Text-Show.html#t%3AShow"
+><A HREF="/usr/local/share/doc/ghc/libraries/base/Text-Show.html#t%3AShow"
hunk ./doc/html/monoids/Data-Ring-Semi-BitSet.html 479
+><A HREF="/usr/local/share/doc/ghc/libraries/base/Prelude.html#t%3AEnum"
+>Enum</A
+> a =&gt; <A HREF="Data-Generator.html#t%3AGenerator"
+>Generator</A
+> (<A HREF="Data-Ring-Semi-BitSet.html#t%3ABitSet"
+>BitSet</A
+> a)</TD
+></TR
+><TR
+><TD CLASS="decl"
hunk ./doc/html/monoids/src/Data-Ring-Semi-BitSet.html 9
-<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE FlexibleInstances, FlexibleContexts, MultiParamTypeClasses, DeriveDataTypeable, BangPatterns, PatternGuards #-}</span>
+<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE FlexibleInstances, FlexibleContexts, MultiParamTypeClasses, DeriveDataTypeable, BangPatterns, PatternGuards, TypeFamilies #-}</span>
hunk ./doc/html/monoids/src/Data-Ring-Semi-BitSet.html 34
-<a name="line-26"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Ring</span><span class='hs-varop'>.</span><span class='hs-conid'>Algebra</span>
-<a name="line-27"></a>
-<a name="line-28"></a><a name="BitSet"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> 
-<a name="line-29"></a>        <span class='hs-layout'>{</span> <span class='hs-sel'>_countAtLeast</span>  <span class='hs-keyglyph'>::</span> <span class='hs-comment'>{-# UNPACK #-}</span> <span class='hs-varop'>!</span><span class='hs-conid'>Int</span>       <span class='hs-comment'>-- ^ a conservative upper bound on the element count</span>
-<a name="line-30"></a>        <span class='hs-layout'>,</span> <span class='hs-sel'>_countAtMost</span>   <span class='hs-keyglyph'>::</span> <span class='hs-comment'>{-# UNPACK #-}</span> <span class='hs-varop'>!</span><span class='hs-conid'>Int</span>       <span class='hs-comment'>-- ^ a conservative lower bound on the element count</span>
-<a name="line-31"></a>        <span class='hs-layout'>,</span> <span class='hs-sel'>_count</span>         <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span>                       <span class='hs-comment'>-- ^ the actual element count (lazy) used when the above two disagree</span>
-<a name="line-32"></a>        <span class='hs-layout'>,</span> <span class='hs-varid'>exponent</span>      <span class='hs-keyglyph'>::</span> <span class='hs-comment'>{-# UNPACK #-}</span> <span class='hs-varop'>!</span><span class='hs-conid'>Int</span>       <span class='hs-comment'>-- ^ low water mark</span>
-<a name="line-33"></a>        <span class='hs-layout'>,</span> <span class='hs-sel'>_hwm</span>           <span class='hs-keyglyph'>::</span> <span class='hs-comment'>{-# UNPACK #-}</span> <span class='hs-varop'>!</span><span class='hs-conid'>Int</span>       <span class='hs-comment'>-- ^ high water mark</span>
-<a name="line-34"></a>        <span class='hs-layout'>,</span> <span class='hs-varid'>mantissa</span>      <span class='hs-keyglyph'>::</span> <span class='hs-comment'>{-# UNPACK #-}</span> <span class='hs-varop'>!</span><span class='hs-conid'>Integer</span>   <span class='hs-comment'>-- ^ the set of bits. TODO: negative mantissa = complement</span>
-<a name="line-35"></a>        <span class='hs-layout'>,</span> <span class='hs-sel'>_universe</span>      <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span><span class='hs-conid'>Int</span><span class='hs-layout'>)</span>                 <span class='hs-comment'>-- ^ invariant: mantissa &lt; 0 =&gt; universe = (fromEnum minBound,fromEnum maxBound)</span>
-<a name="line-36"></a>        <span class='hs-layout'>}</span> <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span><span class='hs-layout'>)</span>
-<a name="line-37"></a>
-<a name="line-38"></a><a name="bs"></a><span class='hs-comment'>-- | internal smart constructor: makes sure the count is forced when known</span>
-<a name="line-39"></a><span class='hs-definition'>bs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span><span class='hs-conid'>Int</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span>
-<a name="line-40"></a><a name="!"></a><span class='hs-definition'>bs</span> <span class='hs-varop'>!</span><span class='hs-varid'>a</span> <span class='hs-varop'>!</span><span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varop'>!</span><span class='hs-varid'>l</span> <span class='hs-varop'>!</span><span class='hs-varid'>h</span> <span class='hs-varop'>!</span><span class='hs-varid'>m</span> <span class='hs-varid'>u</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>u</span>
-<a name="line-41"></a>                      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>u</span>
-<a name="line-42"></a><span class='hs-comment'>{-# INLINE bs #-}</span>
-<a name="line-43"></a>
-<a name="line-44"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Show</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Show</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
-<a name="line-45"></a>    <span class='hs-varid'>show</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span> <span class='hs-str'>"fromDistinctAscList "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-layout'>(</span><span class='hs-varid'>toList</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span>
-<a name="line-46"></a>
-<a name="line-47"></a><a name="toList"></a><span class='hs-comment'>-- | /O(d)/ where /d/ is absolute deviation in fromEnum from the least element in the set.</span>
-<a name="line-48"></a><span class='hs-definition'>toList</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
-<a name="line-49"></a><span class='hs-definition'>toList</span> <span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>u</span><span class='hs-layout'>)</span> 
-<a name="line-50"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-varid'>toEnum</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ul</span><span class='hs-keyglyph'>..</span><span class='hs-varid'>max</span> <span class='hs-layout'>(</span><span class='hs-varid'>pred</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varid'>ul</span><span class='hs-keyglyph'>]</span> <span class='hs-varop'>++</span> <span class='hs-varid'>toList'</span> <span class='hs-varid'>l</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>toEnum</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>min</span> <span class='hs-layout'>(</span><span class='hs-varid'>succ</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>uh</span><span class='hs-keyglyph'>..</span><span class='hs-varid'>uh</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
-<a name="line-51"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toList'</span> <span class='hs-num'>0</span> <span class='hs-conid'>[]</span>
-<a name="line-52"></a>    <span class='hs-keyword'>where</span>
-<a name="line-53"></a>        <span class='hs-keyglyph'>~</span><span class='hs-layout'>(</span><span class='hs-varid'>ul</span><span class='hs-layout'>,</span><span class='hs-varid'>uh</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>u</span>
-<a name="line-54"></a>        <span class='hs-varid'>toList'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
-<a name="line-55"></a>        <span class='hs-varid'>toList'</span> <span class='hs-varop'>!</span><span class='hs-varid'>n</span> <span class='hs-varid'>t</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>n</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>h</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>t</span>
-<a name="line-56"></a>                     <span class='hs-keyglyph'>|</span> <span class='hs-varid'>testBit</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toEnum</span> <span class='hs-varid'>n</span> <span class='hs-conop'>:</span> <span class='hs-varid'>toList'</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>t</span>
-<a name="line-57"></a>                     <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toList'</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>t</span>
-<a name="line-58"></a><span class='hs-comment'>{-# INLINE toList #-}</span>
-<a name="line-59"></a>
-<a name="line-60"></a><a name="empty"></a><span class='hs-comment'>-- | The empty bit set.</span>
-<a name="line-61"></a><span class='hs-definition'>empty</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span>
-<a name="line-62"></a><span class='hs-definition'>empty</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>undefined</span>
-<a name="line-63"></a><span class='hs-comment'>{-# INLINE empty #-}</span>
-<a name="line-64"></a>
-<a name="line-65"></a><a name="singleton"></a><span class='hs-definition'>singleton</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> 
-<a name="line-66"></a><span class='hs-definition'>singleton</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-num'>1</span> <span class='hs-num'>1</span> <span class='hs-num'>1</span> <span class='hs-varid'>e</span> <span class='hs-varid'>e</span> <span class='hs-num'>1</span> <span class='hs-varid'>undefined</span> <span class='hs-keyword'>where</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-varid'>x</span>
-<a name="line-67"></a><span class='hs-comment'>{-# INLINE singleton #-}</span>
+<a name="line-26"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Generator</span>
+<a name="line-27"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Ring</span><span class='hs-varop'>.</span><span class='hs-conid'>Algebra</span>
+<a name="line-28"></a>
+<a name="line-29"></a><a name="BitSet"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> 
+<a name="line-30"></a>        <span class='hs-layout'>{</span> <span class='hs-sel'>_countAtLeast</span>  <span class='hs-keyglyph'>::</span> <span class='hs-comment'>{-# UNPACK #-}</span> <span class='hs-varop'>!</span><span class='hs-conid'>Int</span>       <span class='hs-comment'>-- ^ a conservative upper bound on the element count</span>
+<a name="line-31"></a>        <span class='hs-layout'>,</span> <span class='hs-sel'>_countAtMost</span>   <span class='hs-keyglyph'>::</span> <span class='hs-comment'>{-# UNPACK #-}</span> <span class='hs-varop'>!</span><span class='hs-conid'>Int</span>       <span class='hs-comment'>-- ^ a conservative lower bound on the element count</span>
+<a name="line-32"></a>        <span class='hs-layout'>,</span> <span class='hs-sel'>_count</span>         <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span>                       <span class='hs-comment'>-- ^ the actual element count (lazy) used when the above two disagree</span>
+<a name="line-33"></a>        <span class='hs-layout'>,</span> <span class='hs-varid'>exponent</span>      <span class='hs-keyglyph'>::</span> <span class='hs-comment'>{-# UNPACK #-}</span> <span class='hs-varop'>!</span><span class='hs-conid'>Int</span>       <span class='hs-comment'>-- ^ low water mark</span>
+<a name="line-34"></a>        <span class='hs-layout'>,</span> <span class='hs-sel'>_hwm</span>           <span class='hs-keyglyph'>::</span> <span class='hs-comment'>{-# UNPACK #-}</span> <span class='hs-varop'>!</span><span class='hs-conid'>Int</span>       <span class='hs-comment'>-- ^ high water mark</span>
+<a name="line-35"></a>        <span class='hs-layout'>,</span> <span class='hs-varid'>mantissa</span>      <span class='hs-keyglyph'>::</span> <span class='hs-comment'>{-# UNPACK #-}</span> <span class='hs-varop'>!</span><span class='hs-conid'>Integer</span>   <span class='hs-comment'>-- ^ the set of bits. TODO: negative mantissa = complement</span>
+<a name="line-36"></a>        <span class='hs-layout'>,</span> <span class='hs-sel'>_universe</span>      <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span><span class='hs-conid'>Int</span><span class='hs-layout'>)</span>                 <span class='hs-comment'>-- ^ invariant: mantissa &lt; 0 =&gt; universe = (fromEnum minBound,fromEnum maxBound)</span>
+<a name="line-37"></a>        <span class='hs-layout'>}</span> <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span><span class='hs-layout'>,</span><span class='hs-conid'>Show</span><span class='hs-layout'>)</span>
+<a name="line-38"></a>
+<a name="line-39"></a><a name="debug"></a><span class='hs-definition'>debug</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span><span class='hs-conid'>Integer</span><span class='hs-layout'>)</span>
+<a name="line-40"></a><span class='hs-definition'>debug</span> <span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>,</span><span class='hs-varid'>c</span><span class='hs-layout'>,</span><span class='hs-varid'>d</span><span class='hs-layout'>,</span><span class='hs-varid'>e</span><span class='hs-layout'>,</span><span class='hs-varid'>f</span><span class='hs-layout'>)</span>
+<a name="line-41"></a>
+<a name="line-42"></a><a name="bs"></a><span class='hs-comment'>-- | internal smart constructor: makes sure the count is forced when known</span>
+<a name="line-43"></a><span class='hs-definition'>bs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span><span class='hs-conid'>Int</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span>
+<a name="line-44"></a><a name="!"></a><span class='hs-definition'>bs</span> <span class='hs-varop'>!</span><span class='hs-varid'>a</span> <span class='hs-varop'>!</span><span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varop'>!</span><span class='hs-varid'>l</span> <span class='hs-varop'>!</span><span class='hs-varid'>h</span> <span class='hs-varop'>!</span><span class='hs-varid'>m</span> <span class='hs-varid'>u</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>u</span>
+<a name="line-45"></a>                      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>u</span>
+<a name="line-46"></a><span class='hs-comment'>{-# INLINE bs #-}</span>
+<a name="line-47"></a>
+<a name="line-48"></a><span class='hs-comment'>-- instance (Enum a, Show a) =&gt; Show (BitSet a) where</span>
+<a name="line-49"></a><span class='hs-comment'>--    show s = "fromDistinctAscList " ++ show (toList s) ++ </span>
+<a name="line-50"></a>
+<a name="line-51"></a><a name="toList"></a><span class='hs-comment'>-- | /O(d)/ where /d/ is absolute deviation in fromEnum from the least element in the set.</span>
+<a name="line-52"></a><span class='hs-definition'>toList</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
+<a name="line-53"></a><span class='hs-definition'>toList</span> <span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>u</span><span class='hs-layout'>)</span> 
+<a name="line-54"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-varid'>toEnum</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ul</span><span class='hs-keyglyph'>..</span><span class='hs-varid'>max</span> <span class='hs-layout'>(</span><span class='hs-varid'>pred</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varid'>ul</span><span class='hs-keyglyph'>]</span> <span class='hs-varop'>++</span> <span class='hs-varid'>toList'</span> <span class='hs-varid'>l</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>toEnum</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>min</span> <span class='hs-layout'>(</span><span class='hs-varid'>succ</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>uh</span><span class='hs-keyglyph'>..</span><span class='hs-varid'>uh</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
+<a name="line-55"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toList'</span> <span class='hs-num'>0</span> <span class='hs-conid'>[]</span>
+<a name="line-56"></a>    <span class='hs-keyword'>where</span>
+<a name="line-57"></a>        <span class='hs-keyglyph'>~</span><span class='hs-layout'>(</span><span class='hs-varid'>ul</span><span class='hs-layout'>,</span><span class='hs-varid'>uh</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>u</span>
+<a name="line-58"></a>        <span class='hs-varid'>toList'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
+<a name="line-59"></a>        <span class='hs-varid'>toList'</span> <span class='hs-varop'>!</span><span class='hs-varid'>n</span> <span class='hs-varid'>t</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>n</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>h</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>t</span>
+<a name="line-60"></a>                     <span class='hs-keyglyph'>|</span> <span class='hs-varid'>testBit</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toEnum</span> <span class='hs-varid'>n</span> <span class='hs-conop'>:</span> <span class='hs-varid'>toList'</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>t</span>
+<a name="line-61"></a>                     <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toList'</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>t</span>
+<a name="line-62"></a><span class='hs-comment'>{-# INLINE toList #-}</span>
+<a name="line-63"></a>
+<a name="line-64"></a><a name="empty"></a><span class='hs-comment'>-- | The empty bit set.</span>
+<a name="line-65"></a><span class='hs-definition'>empty</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span>
+<a name="line-66"></a><span class='hs-definition'>empty</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>undefined</span>
+<a name="line-67"></a><span class='hs-comment'>{-# INLINE empty #-}</span>
hunk ./doc/html/monoids/src/Data-Ring-Semi-BitSet.html 77
-<a name="line-69"></a><a name="null"></a><span class='hs-comment'>-- | Is the bit set empty? Asymptotically faster than checking if size == 0 in some cases.</span>
-<a name="line-70"></a><span class='hs-definition'>null</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
-<a name="line-71"></a><span class='hs-definition'>null</span> <span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> 
-<a name="line-72"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a</span> <span class='hs-varop'>&gt;</span> <span class='hs-num'>0</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
-<a name="line-73"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>b</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
-<a name="line-74"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>c</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> 
-<a name="line-75"></a><span class='hs-comment'>{-# INLINE null #-}</span>
-<a name="line-76"></a>
-<a name="line-77"></a><a name="full"></a><span class='hs-definition'>full</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span>
-<a name="line-78"></a><span class='hs-definition'>full</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>complement</span> <span class='hs-varid'>empty</span> 
-<a name="line-79"></a>
-<a name="line-80"></a><a name="universeOf"></a><span class='hs-definition'>universeOf</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span><span class='hs-conid'>Int</span><span class='hs-layout'>)</span>
-<a name="line-81"></a><span class='hs-definition'>universeOf</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromEnum</span> <span class='hs-layout'>(</span><span class='hs-varid'>minBound</span> <span class='hs-varop'>`asArgTypeOf`</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromEnum</span> <span class='hs-layout'>(</span><span class='hs-varid'>maxBound</span> <span class='hs-varop'>`asArgTypeOf`</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
-<a name="line-82"></a>
-<a name="line-83"></a><a name="complement"></a><span class='hs-comment'>-- ensures valid universe, may result in negative bitset, note recalculation of universe</span>
-<a name="line-84"></a><span class='hs-definition'>complement</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> 
-<a name="line-85"></a><span class='hs-definition'>complement</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>universeOf</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>
+<a name="line-69"></a><a name="singleton"></a><span class='hs-definition'>singleton</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> 
+<a name="line-70"></a><span class='hs-definition'>singleton</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-num'>1</span> <span class='hs-num'>1</span> <span class='hs-num'>1</span> <span class='hs-varid'>e</span> <span class='hs-varid'>e</span> <span class='hs-num'>1</span> <span class='hs-varid'>undefined</span> <span class='hs-keyword'>where</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-varid'>x</span>
+<a name="line-71"></a><span class='hs-comment'>{-# INLINE singleton #-}</span>
+<a name="line-72"></a>
+<a name="line-73"></a><a name="null"></a><span class='hs-comment'>-- | Is the bit set empty? Asymptotically faster than checking if size == 0 in some cases.</span>
+<a name="line-74"></a><span class='hs-definition'>null</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
+<a name="line-75"></a><span class='hs-definition'>null</span> <span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> 
+<a name="line-76"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a</span> <span class='hs-varop'>&gt;</span> <span class='hs-num'>0</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
+<a name="line-77"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>b</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
+<a name="line-78"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>c</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> 
+<a name="line-79"></a><span class='hs-comment'>{-# INLINE null #-}</span>
+<a name="line-80"></a>
+<a name="line-81"></a><a name="full"></a><span class='hs-definition'>full</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span>
+<a name="line-82"></a><span class='hs-definition'>full</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>complement</span> <span class='hs-varid'>empty</span> 
+<a name="line-83"></a>
+<a name="line-84"></a><a name="universeOf"></a><span class='hs-definition'>universeOf</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span><span class='hs-conid'>Int</span><span class='hs-layout'>)</span>
+<a name="line-85"></a><span class='hs-definition'>universeOf</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromEnum</span> <span class='hs-layout'>(</span><span class='hs-varid'>minBound</span> <span class='hs-varop'>`asArgTypeOf`</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromEnum</span> <span class='hs-layout'>(</span><span class='hs-varid'>maxBound</span> <span class='hs-varop'>`asArgTypeOf`</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
hunk ./doc/html/monoids/src/Data-Ring-Semi-BitSet.html 95
-<a name="line-87"></a><a name="recomplement"></a><span class='hs-comment'>-- proof obligation: either the value is already complemented or it is a complement-complement, note retention of u</span>
-<a name="line-88"></a><span class='hs-definition'>recomplement</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> 
-<a name="line-89"></a><span class='hs-definition'>recomplement</span> <span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>u</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varid'>u</span>
+<a name="line-87"></a><a name="complement"></a><span class='hs-comment'>-- ensures valid universe, may result in negative bitset, note recalculation of universe</span>
+<a name="line-88"></a><span class='hs-definition'>complement</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> 
+<a name="line-89"></a><span class='hs-definition'>complement</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>universeOf</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>
hunk ./doc/html/monoids/src/Data-Ring-Semi-BitSet.html 99
-<a name="line-91"></a><a name="fromList"></a><span class='hs-comment'>-- | /O(d * n)/ Make a @BitSet@ from a list of items.</span>
-<a name="line-92"></a><span class='hs-definition'>fromList</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span>
-<a name="line-93"></a><span class='hs-definition'>fromList</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>foldr</span> <span class='hs-varid'>insert</span> <span class='hs-varid'>empty</span> 
-<a name="line-94"></a><span class='hs-comment'>{-# INLINE fromList #-}</span>
-<a name="line-95"></a>
-<a name="line-96"></a><a name="fromDistinctAscList"></a><span class='hs-definition'>fromDistinctAscList</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> 
-<a name="line-97"></a><span class='hs-definition'>fromDistinctAscList</span> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
-<a name="line-98"></a><span class='hs-definition'>fromDistinctAscList</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span><span class='hs-conop'>:</span><span class='hs-varid'>cs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromDistinctAscList'</span> <span class='hs-varid'>cs</span> <span class='hs-num'>1</span> <span class='hs-num'>0</span> <span class='hs-num'>1</span> 
-<a name="line-99"></a>    <span class='hs-keyword'>where</span>
-<a name="line-100"></a>        <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-varid'>c</span>
-<a name="line-101"></a>        <span class='hs-varid'>fromDistinctAscList'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span>
-<a name="line-102"></a>        <span class='hs-varid'>fromDistinctAscList'</span> <span class='hs-conid'>[]</span> <span class='hs-varop'>!</span><span class='hs-varid'>n</span> <span class='hs-varop'>!</span><span class='hs-varid'>h</span> <span class='hs-varop'>!</span><span class='hs-varid'>m</span>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-varid'>n</span> <span class='hs-varid'>n</span> <span class='hs-varid'>n</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>undefined</span>
-<a name="line-103"></a>        <span class='hs-varid'>fromDistinctAscList'</span> <span class='hs-layout'>(</span><span class='hs-varid'>c'</span><span class='hs-conop'>:</span><span class='hs-varid'>cs'</span><span class='hs-layout'>)</span> <span class='hs-varop'>!</span><span class='hs-varid'>n</span> <span class='hs-keyword'>_</span> <span class='hs-varop'>!</span><span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromDistinctAscList'</span> <span class='hs-varid'>cs'</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>h'</span> <span class='hs-layout'>(</span><span class='hs-varid'>setBit</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>h'</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
-<a name="line-104"></a>            <span class='hs-keyword'>where</span>
-<a name="line-105"></a>                <span class='hs-varid'>h'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-varid'>c'</span>
-<a name="line-106"></a><span class='hs-comment'>{-# INLINE fromDistinctAscList #-}</span>
-<a name="line-107"></a>
-<a name="line-108"></a><a name="insert"></a><span class='hs-comment'>-- | /O(d)/ Insert an item into the bit set.</span>
-<a name="line-109"></a><span class='hs-definition'>insert</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span>
-<a name="line-110"></a><span class='hs-definition'>insert</span> <span class='hs-varid'>x</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>u</span><span class='hs-layout'>)</span> 
-<a name="line-111"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span><span class='hs-layout'>,</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>r</span> 
-<a name="line-112"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span><span class='hs-layout'>,</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>h</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>r</span>
-<a name="line-113"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-varid'>h</span> <span class='hs-comment'>-</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>shiftL</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span> <span class='hs-comment'>-</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varop'>.|.</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>u</span>
-<a name="line-114"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>h</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-varid'>p</span> <span class='hs-layout'>(</span><span class='hs-varid'>setBit</span> <span class='hs-varid'>m</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-varid'>u</span>
-<a name="line-115"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>testBit</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>e</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>r</span> 
-<a name="line-116"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-layout'>(</span><span class='hs-varid'>setBit</span> <span class='hs-varid'>m</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-varid'>u</span>
-<a name="line-117"></a>    <span class='hs-keyword'>where</span> 
-<a name="line-118"></a>        <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-varid'>x</span>
-<a name="line-119"></a>        <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>e</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span> 
-<a name="line-120"></a><span class='hs-comment'>{-# INLINE insert #-}</span>
-<a name="line-121"></a>
-<a name="line-122"></a><a name="delete"></a><span class='hs-comment'>-- | /O(d)/ Delete an item from the bit set.</span>
-<a name="line-123"></a><span class='hs-definition'>delete</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span>
-<a name="line-124"></a><span class='hs-definition'>delete</span> <span class='hs-varid'>x</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>u</span><span class='hs-layout'>)</span> 
-<a name="line-125"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span><span class='hs-layout'>,</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-varid'>h</span> <span class='hs-comment'>-</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>shiftL</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span> <span class='hs-comment'>-</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varop'>.&amp;.</span> <span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>u</span>
-<a name="line-126"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span><span class='hs-layout'>,</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>h</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-varid'>p</span> <span class='hs-layout'>(</span><span class='hs-varid'>clearBit</span> <span class='hs-varid'>m</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-varid'>u</span>
-<a name="line-127"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>r</span>
-<a name="line-128"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>h</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>r</span>
-<a name="line-129"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>testBit</span> <span class='hs-varid'>m</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-layout'>(</span><span class='hs-varid'>clearBit</span> <span class='hs-varid'>m</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-varid'>u</span>
-<a name="line-130"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>r</span>
-<a name="line-131"></a>    <span class='hs-keyword'>where</span> 
-<a name="line-132"></a>        <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-varid'>x</span>
-<a name="line-133"></a>        <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>e</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span>
-<a name="line-134"></a><span class='hs-comment'>{-# INLINE delete #-}</span>
-<a name="line-135"></a>
-<a name="line-136"></a><a name="member"></a><span class='hs-comment'>-- | /O(testBit on Integer)/ Ask whether the item is in the bit set.</span>
-<a name="line-137"></a><span class='hs-definition'>member</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
-<a name="line-138"></a><span class='hs-definition'>member</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> 
-<a name="line-139"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span> 
-<a name="line-140"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>h</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&gt;</span> <span class='hs-num'>0</span>
-<a name="line-141"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>testBit</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>e</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span>
-<a name="line-142"></a>    <span class='hs-keyword'>where</span> 
-<a name="line-143"></a>        <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-varid'>x</span>
-<a name="line-144"></a><span class='hs-comment'>{-# INLINE member #-}</span>
-<a name="line-145"></a>
-<a name="line-146"></a><a name="size"></a><span class='hs-comment'>-- | /O(1)/ or /O(d)/ The number of elements in the bit set.</span>
-<a name="line-147"></a><span class='hs-definition'>size</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
-<a name="line-148"></a><span class='hs-definition'>size</span> <span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>ul</span><span class='hs-layout'>,</span><span class='hs-varid'>uh</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> 
-<a name="line-149"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b</span><span class='hs-layout'>,</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&gt;=</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span>
-<a name="line-150"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>uh</span> <span class='hs-comment'>-</span> <span class='hs-varid'>ul</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a</span> 
-<a name="line-151"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&gt;=</span> <span class='hs-num'>0</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>c</span>
-<a name="line-152"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>uh</span> <span class='hs-comment'>-</span> <span class='hs-varid'>ul</span> <span class='hs-comment'>-</span> <span class='hs-varid'>c</span> 
-<a name="line-153"></a>
-<a name="line-154"></a><a name="toInteger"></a><span class='hs-comment'>-- | /O(d)/ convert to an Integer representation. Discards negative elements</span>
-<a name="line-155"></a><span class='hs-definition'>toInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
-<a name="line-156"></a><span class='hs-definition'>toInteger</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mantissa</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`shift`</span> <span class='hs-varid'>exponent</span> <span class='hs-varid'>x</span>
+<a name="line-91"></a><a name="recomplement"></a><span class='hs-comment'>-- proof obligation: either the value is already complemented or it is a complement-complement, note retention of u</span>
+<a name="line-92"></a><span class='hs-definition'>recomplement</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> 
+<a name="line-93"></a><span class='hs-definition'>recomplement</span> <span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>u</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varid'>u</span>
+<a name="line-94"></a>
+<a name="line-95"></a><a name="fromList"></a><span class='hs-comment'>-- | /O(d * n)/ Make a @BitSet@ from a list of items.</span>
+<a name="line-96"></a><span class='hs-definition'>fromList</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span>
+<a name="line-97"></a><span class='hs-definition'>fromList</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>foldr</span> <span class='hs-varid'>insert</span> <span class='hs-varid'>empty</span> 
+<a name="line-98"></a><span class='hs-comment'>{-# INLINE fromList #-}</span>
+<a name="line-99"></a>
+<a name="line-100"></a><a name="fromDistinctAscList"></a><span class='hs-definition'>fromDistinctAscList</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> 
+<a name="line-101"></a><span class='hs-definition'>fromDistinctAscList</span> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
+<a name="line-102"></a><span class='hs-definition'>fromDistinctAscList</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span><span class='hs-conop'>:</span><span class='hs-varid'>cs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromDistinctAscList'</span> <span class='hs-varid'>cs</span> <span class='hs-num'>1</span> <span class='hs-num'>0</span> <span class='hs-num'>1</span> 
+<a name="line-103"></a>    <span class='hs-keyword'>where</span>
+<a name="line-104"></a>        <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-varid'>c</span>
+<a name="line-105"></a>        <span class='hs-varid'>fromDistinctAscList'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span>
+<a name="line-106"></a>        <span class='hs-varid'>fromDistinctAscList'</span> <span class='hs-conid'>[]</span> <span class='hs-varop'>!</span><span class='hs-varid'>n</span> <span class='hs-varop'>!</span><span class='hs-varid'>h</span> <span class='hs-varop'>!</span><span class='hs-varid'>m</span>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-varid'>n</span> <span class='hs-varid'>n</span> <span class='hs-varid'>n</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>undefined</span>
+<a name="line-107"></a>        <span class='hs-varid'>fromDistinctAscList'</span> <span class='hs-layout'>(</span><span class='hs-varid'>c'</span><span class='hs-conop'>:</span><span class='hs-varid'>cs'</span><span class='hs-layout'>)</span> <span class='hs-varop'>!</span><span class='hs-varid'>n</span> <span class='hs-keyword'>_</span> <span class='hs-varop'>!</span><span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromDistinctAscList'</span> <span class='hs-varid'>cs'</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>h'</span> <span class='hs-layout'>(</span><span class='hs-varid'>setBit</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>h'</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
+<a name="line-108"></a>            <span class='hs-keyword'>where</span>
+<a name="line-109"></a>                <span class='hs-varid'>h'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-varid'>c'</span>
+<a name="line-110"></a><span class='hs-comment'>{-# INLINE fromDistinctAscList #-}</span>
+<a name="line-111"></a>
+<a name="line-112"></a><a name="insert"></a><span class='hs-comment'>-- | /O(d)/ Insert an item into the bit set.</span>
+<a name="line-113"></a><span class='hs-definition'>insert</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span>
+<a name="line-114"></a><span class='hs-definition'>insert</span> <span class='hs-varid'>x</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>u</span><span class='hs-layout'>)</span> 
+<a name="line-115"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span><span class='hs-layout'>,</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>r</span> 
+<a name="line-116"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span><span class='hs-layout'>,</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>h</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>r</span>
+<a name="line-117"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-varid'>h</span> <span class='hs-comment'>-</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>shiftL</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span> <span class='hs-comment'>-</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varop'>.|.</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>u</span>
+<a name="line-118"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>h</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-varid'>p</span> <span class='hs-layout'>(</span><span class='hs-varid'>setBit</span> <span class='hs-varid'>m</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-varid'>u</span>
+<a name="line-119"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>testBit</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>e</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>r</span> 
+<a name="line-120"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-layout'>(</span><span class='hs-varid'>setBit</span> <span class='hs-varid'>m</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-varid'>u</span>
+<a name="line-121"></a>    <span class='hs-keyword'>where</span> 
+<a name="line-122"></a>        <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-varid'>x</span>
+<a name="line-123"></a>        <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>e</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span> 
+<a name="line-124"></a><span class='hs-comment'>{-# INLINE insert #-}</span>
+<a name="line-125"></a>
+<a name="line-126"></a><a name="delete"></a><span class='hs-comment'>-- | /O(d)/ Delete an item from the bit set.</span>
+<a name="line-127"></a><span class='hs-definition'>delete</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span>
+<a name="line-128"></a><span class='hs-definition'>delete</span> <span class='hs-varid'>x</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>u</span><span class='hs-layout'>)</span> 
+<a name="line-129"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span><span class='hs-layout'>,</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-varid'>h</span> <span class='hs-comment'>-</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>shiftL</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span> <span class='hs-comment'>-</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varop'>.&amp;.</span> <span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>u</span>
+<a name="line-130"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span><span class='hs-layout'>,</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>h</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-varid'>p</span> <span class='hs-layout'>(</span><span class='hs-varid'>clearBit</span> <span class='hs-varid'>m</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-varid'>u</span>
+<a name="line-131"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>r</span>
+<a name="line-132"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>h</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>r</span>
+<a name="line-133"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>testBit</span> <span class='hs-varid'>m</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-layout'>(</span><span class='hs-varid'>clearBit</span> <span class='hs-varid'>m</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-varid'>u</span>
+<a name="line-134"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>r</span>
+<a name="line-135"></a>    <span class='hs-keyword'>where</span> 
+<a name="line-136"></a>        <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-varid'>x</span>
+<a name="line-137"></a>        <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>e</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span>
+<a name="line-138"></a><span class='hs-comment'>{-# INLINE delete #-}</span>
+<a name="line-139"></a>
+<a name="line-140"></a><a name="member"></a><span class='hs-comment'>-- | /O(testBit on Integer)/ Ask whether the item is in the bit set.</span>
+<a name="line-141"></a><span class='hs-definition'>member</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
+<a name="line-142"></a><span class='hs-definition'>member</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> 
+<a name="line-143"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span> 
+<a name="line-144"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>h</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&gt;</span> <span class='hs-num'>0</span>
+<a name="line-145"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>testBit</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>e</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span>
+<a name="line-146"></a>    <span class='hs-keyword'>where</span> 
+<a name="line-147"></a>        <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-varid'>x</span>
+<a name="line-148"></a><span class='hs-comment'>{-# INLINE member #-}</span>
+<a name="line-149"></a>
+<a name="line-150"></a><a name="size"></a><span class='hs-comment'>-- | /O(1)/ or /O(d)/ The number of elements in the bit set.</span>
+<a name="line-151"></a><span class='hs-definition'>size</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
+<a name="line-152"></a><span class='hs-definition'>size</span> <span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>ul</span><span class='hs-layout'>,</span><span class='hs-varid'>uh</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> 
+<a name="line-153"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b</span><span class='hs-layout'>,</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&gt;=</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span>
+<a name="line-154"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>uh</span> <span class='hs-comment'>-</span> <span class='hs-varid'>ul</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a</span> 
+<a name="line-155"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&gt;=</span> <span class='hs-num'>0</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>c</span>
+<a name="line-156"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>uh</span> <span class='hs-comment'>-</span> <span class='hs-varid'>ul</span> <span class='hs-comment'>-</span> <span class='hs-varid'>c</span> 
hunk ./doc/html/monoids/src/Data-Ring-Semi-BitSet.html 166
-<a name="line-158"></a><a name="union"></a><span class='hs-definition'>union</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> 
-<a name="line-159"></a><span class='hs-definition'>union</span> <span class='hs-varid'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>u</span><span class='hs-layout'>)</span> <span class='hs-varid'>y</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a'</span> <span class='hs-varid'>b'</span> <span class='hs-varid'>c'</span> <span class='hs-varid'>l'</span> <span class='hs-varid'>h'</span> <span class='hs-varid'>m'</span> <span class='hs-varid'>u'</span><span class='hs-layout'>)</span>
-<a name="line-160"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>l'</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>union</span> <span class='hs-varid'>y</span> <span class='hs-varid'>x</span>                                                         <span class='hs-comment'>-- ensure left side has lower exponent</span>
-<a name="line-161"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>b</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>y</span>                                                                 <span class='hs-comment'>-- fast empty union</span>
-<a name="line-162"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>b'</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>                                                                 <span class='hs-comment'>-- fast empty union</span>
-<a name="line-163"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a</span> <span class='hs-varop'>==</span> <span class='hs-comment'>-</span><span class='hs-num'>1</span>   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>u</span>                                      <span class='hs-comment'>-- fast full union, recomplement obligation met by negative size</span>
-<a name="line-164"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a'</span> <span class='hs-varop'>==</span> <span class='hs-comment'>-</span><span class='hs-num'>1</span>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>u'</span>                                     <span class='hs-comment'>-- fast full union, recomplement obligation met by negative size</span>
-<a name="line-165"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span><span class='hs-layout'>,</span> <span class='hs-varid'>m'</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recomplement</span> <span class='hs-layout'>(</span><span class='hs-varid'>intersection</span> <span class='hs-layout'>(</span><span class='hs-varid'>recomplement</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>recomplement</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- appeal to intersection, recomplement obligation met by 2s complement</span>
-<a name="line-166"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m'</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pseudoDiff</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><span class='hs-varid'>recomplement</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span>                                     <span class='hs-comment'>-- union with complement, recomplement obligation met by 2s complement</span>
-<a name="line-167"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pseudoDiff</span> <span class='hs-varid'>y</span> <span class='hs-layout'>(</span><span class='hs-varid'>recomplement</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>                                     <span class='hs-comment'>-- union with complement, recomplement obligation met by 2s complement</span>
-<a name="line-168"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>h</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l'</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a'</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b'</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span> <span class='hs-varop'>+</span> <span class='hs-varid'>c'</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-layout'>(</span><span class='hs-varid'>h'</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varid'>m''</span> <span class='hs-varid'>u</span>                    <span class='hs-comment'>-- disjoint positive ranges</span>
-<a name="line-169"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-varop'>`max`</span> <span class='hs-varid'>a'</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b'</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>recount</span> <span class='hs-varid'>m''</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-layout'>(</span><span class='hs-varid'>h</span> <span class='hs-varop'>`max`</span> <span class='hs-varid'>h'</span><span class='hs-layout'>)</span> <span class='hs-varid'>m''</span> <span class='hs-varid'>u</span>       <span class='hs-comment'>-- overlapped positives</span>
-<a name="line-170"></a>    <span class='hs-keyword'>where</span> 
-<a name="line-171"></a>        <span class='hs-varid'>m''</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>m</span> <span class='hs-varop'>.|.</span> <span class='hs-varid'>shiftL</span> <span class='hs-varid'>m'</span> <span class='hs-layout'>(</span><span class='hs-varid'>l'</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span>
-<a name="line-172"></a>
-<a name="line-173"></a><a name="intersection"></a><span class='hs-definition'>intersection</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> 
-<a name="line-174"></a><span class='hs-definition'>intersection</span> <span class='hs-varid'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>u</span><span class='hs-layout'>)</span> <span class='hs-varid'>y</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a'</span> <span class='hs-varid'>b'</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l'</span> <span class='hs-varid'>h'</span> <span class='hs-varid'>m'</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>
-<a name="line-175"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>l'</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>intersection</span> <span class='hs-varid'>y</span> <span class='hs-varid'>x</span>                                 
-<a name="line-176"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>b</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
-<a name="line-177"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>b'</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
-<a name="line-178"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a</span> <span class='hs-varop'>==</span> <span class='hs-comment'>-</span><span class='hs-num'>1</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>y</span>
-<a name="line-179"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a'</span> <span class='hs-varop'>==</span> <span class='hs-comment'>-</span><span class='hs-num'>1</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
-<a name="line-180"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span><span class='hs-layout'>,</span> <span class='hs-varid'>m'</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recomplement</span> <span class='hs-layout'>(</span><span class='hs-varid'>union</span> <span class='hs-layout'>(</span><span class='hs-varid'>recomplement</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>recomplement</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
-<a name="line-181"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m'</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pseudoDiff</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span>
-<a name="line-182"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pseudoDiff</span> <span class='hs-varid'>y</span> <span class='hs-varid'>x</span>
-<a name="line-183"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>h</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span> 
-<a name="line-184"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-num'>0</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-varop'>`min`</span> <span class='hs-varid'>b'</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>recount</span> <span class='hs-varid'>m''</span><span class='hs-layout'>)</span> <span class='hs-varid'>l''</span> <span class='hs-layout'>(</span><span class='hs-varid'>h</span> <span class='hs-varop'>`min`</span> <span class='hs-varid'>h'</span><span class='hs-layout'>)</span> <span class='hs-varid'>m''</span> <span class='hs-varid'>u</span>
-<a name="line-185"></a>    <span class='hs-keyword'>where</span>
-<a name="line-186"></a>        <span class='hs-varid'>l''</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>max</span> <span class='hs-varid'>l</span> <span class='hs-varid'>l'</span>
-<a name="line-187"></a>        <span class='hs-varid'>m''</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>shift</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>l''</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varop'>.|.</span> <span class='hs-varid'>shift</span> <span class='hs-varid'>m'</span> <span class='hs-layout'>(</span><span class='hs-varid'>l''</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l'</span><span class='hs-layout'>)</span>
-<a name="line-188"></a>
-<a name="line-189"></a><a name="pseudoDiff"></a><span class='hs-comment'>-- we know m &gt;= 0, m' &gt;= 0, a /= -1, a' /= -1, b /= 0, b' /= 0, u' is the universe of discourse</span>
-<a name="line-190"></a><span class='hs-definition'>pseudoDiff</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> 
-<a name="line-191"></a><span class='hs-definition'>pseudoDiff</span> <span class='hs-varid'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>b'</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l'</span> <span class='hs-varid'>h'</span> <span class='hs-varid'>m'</span> <span class='hs-varid'>u'</span><span class='hs-layout'>)</span> 
-<a name="line-192"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>h</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
-<a name="line-193"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>h'</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
-<a name="line-194"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-layout'>(</span><span class='hs-varid'>max</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-comment'>-</span> <span class='hs-varid'>b'</span><span class='hs-layout'>)</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>recount</span> <span class='hs-varid'>m''</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m''</span> <span class='hs-varid'>u'</span>
-<a name="line-195"></a>    <span class='hs-keyword'>where</span> <span class='hs-varid'>m''</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>m</span> <span class='hs-varop'>.&amp;.</span> <span class='hs-varid'>shift</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-varid'>m'</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>l'</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span>
-<a name="line-196"></a>
-<a name="line-197"></a><a name="\\"></a><span class='hs-layout'>(</span><span class='hs-varop'>\\</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> 
-<a name="line-198"></a><a name="x"></a><span class='hs-definition'>x</span> <span class='hs-varop'>\\</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`union`</span> <span class='hs-varid'>complement</span> <span class='hs-varid'>y</span>
-<a name="line-199"></a>
-<a name="line-200"></a><span class='hs-comment'>-- TODO: fix this so that it handles complements correctly</span>
-<a name="line-201"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Eq</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
-<a name="line-202"></a>    <span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>m</span> <span class='hs-keyword'>_</span> <span class='hs-varop'>==</span> <span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l'</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>m'</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>shift</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>l''</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-varid'>shift</span> <span class='hs-varid'>m'</span> <span class='hs-layout'>(</span><span class='hs-varid'>l''</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span> <span class='hs-varid'>l''</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>min</span> <span class='hs-varid'>l</span> <span class='hs-varid'>l'</span>
-<a name="line-203"></a>    <span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>m</span> <span class='hs-keyword'>_</span> <span class='hs-varop'>/=</span> <span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l'</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>m'</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>shift</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>l''</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varop'>/=</span> <span class='hs-varid'>shift</span> <span class='hs-varid'>m'</span> <span class='hs-layout'>(</span><span class='hs-varid'>l''</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span> <span class='hs-varid'>l''</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>min</span> <span class='hs-varid'>l</span> <span class='hs-varid'>l'</span>
-<a name="line-204"></a>
-<a name="line-205"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Ord</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
-<a name="line-206"></a>    <span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>m</span> <span class='hs-keyword'>_</span> <span class='hs-varop'>`compare`</span> <span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l'</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>m'</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>shift</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>l''</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varop'>`compare`</span> <span class='hs-varid'>shift</span> <span class='hs-varid'>m'</span> <span class='hs-layout'>(</span><span class='hs-varid'>l''</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span> <span class='hs-varid'>l''</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>min</span> <span class='hs-varid'>l</span> <span class='hs-varid'>l'</span>
-<a name="line-207"></a>
-<a name="line-208"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Bounded</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
-<a name="line-209"></a>    <span class='hs-varid'>minBound</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
-<a name="line-210"></a>    <span class='hs-varid'>maxBound</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>result</span> <span class='hs-keyword'>where</span>
-<a name="line-211"></a>        <span class='hs-varid'>result</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-varid'>n</span> <span class='hs-varid'>n</span> <span class='hs-varid'>n</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span><span class='hs-varid'>h</span><span class='hs-layout'>)</span>
-<a name="line-212"></a>        <span class='hs-varid'>n</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>h</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span> <span class='hs-varop'>+</span> <span class='hs-num'>1</span>
-<a name="line-213"></a>        <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-layout'>(</span><span class='hs-varid'>minBound</span> <span class='hs-varop'>`asArgTypeOf`</span> <span class='hs-varid'>result</span><span class='hs-layout'>)</span>
-<a name="line-214"></a>        <span class='hs-varid'>h</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-layout'>(</span><span class='hs-varid'>maxBound</span> <span class='hs-varop'>`asArgTypeOf`</span> <span class='hs-varid'>result</span><span class='hs-layout'>)</span>
-<a name="line-215"></a>        <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>setBit</span> <span class='hs-num'>0</span> <span class='hs-varid'>n</span> <span class='hs-comment'>-</span> <span class='hs-num'>1</span>
-<a name="line-216"></a>
-<a name="line-217"></a><a name="asArgTypeOf"></a><span class='hs-definition'>asArgTypeOf</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
-<a name="line-218"></a><span class='hs-definition'>asArgTypeOf</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>const</span>
-<a name="line-219"></a><span class='hs-comment'>{-# INLINE asArgTypeOf #-}</span>
+<a name="line-158"></a><a name="toInteger"></a><span class='hs-comment'>-- | /O(d)/ convert to an Integer representation. Discards negative elements</span>
+<a name="line-159"></a><span class='hs-definition'>toInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
+<a name="line-160"></a><span class='hs-definition'>toInteger</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mantissa</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`shift`</span> <span class='hs-varid'>exponent</span> <span class='hs-varid'>x</span>
+<a name="line-161"></a>
+<a name="line-162"></a><a name="union"></a><span class='hs-definition'>union</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> 
+<a name="line-163"></a><span class='hs-definition'>union</span> <span class='hs-varid'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>u</span><span class='hs-layout'>)</span> <span class='hs-varid'>y</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a'</span> <span class='hs-varid'>b'</span> <span class='hs-varid'>c'</span> <span class='hs-varid'>l'</span> <span class='hs-varid'>h'</span> <span class='hs-varid'>m'</span> <span class='hs-varid'>u'</span><span class='hs-layout'>)</span>
+<a name="line-164"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>l'</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>union</span> <span class='hs-varid'>y</span> <span class='hs-varid'>x</span>                                                         <span class='hs-comment'>-- ensure left side has lower exponent</span>
+<a name="line-165"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>b</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>y</span>                                                                 <span class='hs-comment'>-- fast empty union</span>
+<a name="line-166"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>b'</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>                                                                 <span class='hs-comment'>-- fast empty union</span>
+<a name="line-167"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a</span> <span class='hs-varop'>==</span> <span class='hs-comment'>-</span><span class='hs-num'>1</span>   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>u</span>                                      <span class='hs-comment'>-- fast full union, recomplement obligation met by negative size</span>
+<a name="line-168"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a'</span> <span class='hs-varop'>==</span> <span class='hs-comment'>-</span><span class='hs-num'>1</span>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>u'</span>                                     <span class='hs-comment'>-- fast full union, recomplement obligation met by negative size</span>
+<a name="line-169"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span><span class='hs-layout'>,</span> <span class='hs-varid'>m'</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recomplement</span> <span class='hs-layout'>(</span><span class='hs-varid'>intersection</span> <span class='hs-layout'>(</span><span class='hs-varid'>recomplement</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>recomplement</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- appeal to intersection, recomplement obligation met by 2s complement</span>
+<a name="line-170"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m'</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recomplement</span> <span class='hs-layout'>(</span><span class='hs-varid'>pseudoDiff</span> <span class='hs-layout'>(</span><span class='hs-varid'>recomplement</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span> <span class='hs-varid'>u'</span><span class='hs-layout'>)</span>                      <span class='hs-comment'>-- union with complement, recomplement obligation met by 2s complement -- THESE ARE WRONG FIX!</span>
+<a name="line-171"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recomplement</span> <span class='hs-layout'>(</span><span class='hs-varid'>pseudoDiff</span> <span class='hs-layout'>(</span><span class='hs-varid'>recomplement</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varid'>y</span> <span class='hs-varid'>u</span><span class='hs-layout'>)</span>                      <span class='hs-comment'>-- union with complement, recomplement obligation met by 2s complement -- THESE ARE WRONG FIX!</span>
+<a name="line-172"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>h</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l'</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a'</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b'</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span> <span class='hs-varop'>+</span> <span class='hs-varid'>c'</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h'</span> <span class='hs-varid'>m''</span> <span class='hs-varid'>u</span>                          <span class='hs-comment'>-- disjoint positive ranges</span>
+<a name="line-173"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-varop'>`max`</span> <span class='hs-varid'>a'</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b'</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>recount</span> <span class='hs-varid'>m''</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-layout'>(</span><span class='hs-varid'>h</span> <span class='hs-varop'>`max`</span> <span class='hs-varid'>h'</span><span class='hs-layout'>)</span> <span class='hs-varid'>m''</span> <span class='hs-varid'>u</span>       <span class='hs-comment'>-- overlapped positives</span>
+<a name="line-174"></a>    <span class='hs-keyword'>where</span> 
+<a name="line-175"></a>        <span class='hs-varid'>m''</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>m</span> <span class='hs-varop'>.|.</span> <span class='hs-varid'>shiftL</span> <span class='hs-varid'>m'</span> <span class='hs-layout'>(</span><span class='hs-varid'>l'</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span>
+<a name="line-176"></a>
+<a name="line-177"></a><a name="intersection"></a><span class='hs-definition'>intersection</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> 
+<a name="line-178"></a><span class='hs-definition'>intersection</span> <span class='hs-varid'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>u</span><span class='hs-layout'>)</span> <span class='hs-varid'>y</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a'</span> <span class='hs-varid'>b'</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l'</span> <span class='hs-varid'>h'</span> <span class='hs-varid'>m'</span> <span class='hs-varid'>u'</span><span class='hs-layout'>)</span>
+<a name="line-179"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>l'</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>intersection</span> <span class='hs-varid'>y</span> <span class='hs-varid'>x</span>                                 
+<a name="line-180"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>b</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
+<a name="line-181"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>b'</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
+<a name="line-182"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a</span> <span class='hs-varop'>==</span> <span class='hs-comment'>-</span><span class='hs-num'>1</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>y</span>
+<a name="line-183"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a'</span> <span class='hs-varop'>==</span> <span class='hs-comment'>-</span><span class='hs-num'>1</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
+<a name="line-184"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span><span class='hs-layout'>,</span> <span class='hs-varid'>m'</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recomplement</span> <span class='hs-layout'>(</span><span class='hs-varid'>union</span> <span class='hs-layout'>(</span><span class='hs-varid'>recomplement</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>recomplement</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
+<a name="line-185"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m'</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pseudoDiff</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><span class='hs-varid'>recomplement</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-varid'>u'</span>
+<a name="line-186"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pseudoDiff</span> <span class='hs-varid'>y</span> <span class='hs-layout'>(</span><span class='hs-varid'>recomplement</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varid'>u</span>
+<a name="line-187"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>h</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span> 
+<a name="line-188"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-num'>0</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-varop'>`min`</span> <span class='hs-varid'>b'</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>recount</span> <span class='hs-varid'>m''</span><span class='hs-layout'>)</span> <span class='hs-varid'>l''</span> <span class='hs-layout'>(</span><span class='hs-varid'>h</span> <span class='hs-varop'>`min`</span> <span class='hs-varid'>h'</span><span class='hs-layout'>)</span> <span class='hs-varid'>m''</span> <span class='hs-varid'>u</span>
+<a name="line-189"></a>    <span class='hs-keyword'>where</span>
+<a name="line-190"></a>        <span class='hs-varid'>l''</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>max</span> <span class='hs-varid'>l</span> <span class='hs-varid'>l'</span>
+<a name="line-191"></a>        <span class='hs-varid'>m''</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>shift</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>l''</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varop'>.&amp;.</span> <span class='hs-varid'>shift</span> <span class='hs-varid'>m'</span> <span class='hs-layout'>(</span><span class='hs-varid'>l''</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l'</span><span class='hs-layout'>)</span>
+<a name="line-192"></a>
+<a name="line-193"></a><a name="pseudoDiff"></a><span class='hs-comment'>-- we know m &gt;= 0, m' &gt;= 0, a /= -1, a' /= -1, b /= 0, b' /= 0, u' is the universe of discourse</span>
+<a name="line-194"></a><span class='hs-definition'>pseudoDiff</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span><span class='hs-conid'>Int</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> 
+<a name="line-195"></a><span class='hs-definition'>pseudoDiff</span> <span class='hs-varid'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>b'</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l'</span> <span class='hs-varid'>h'</span> <span class='hs-varid'>m'</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>u''</span>
+<a name="line-196"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>h</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
+<a name="line-197"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>h'</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
+<a name="line-198"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span> <span class='hs-layout'>(</span><span class='hs-varid'>max</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-comment'>-</span> <span class='hs-varid'>b'</span><span class='hs-layout'>)</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>recount</span> <span class='hs-varid'>m''</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m''</span> <span class='hs-varid'>u''</span>
+<a name="line-199"></a>    <span class='hs-keyword'>where</span> <span class='hs-varid'>m''</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>m</span> <span class='hs-varop'>.&amp;.</span> <span class='hs-varid'>shift</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bits</span><span class='hs-varop'>.</span><span class='hs-varid'>complement</span> <span class='hs-varid'>m'</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>l'</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span>
+<a name="line-200"></a>
+<a name="line-201"></a><a name="\\"></a><span class='hs-layout'>(</span><span class='hs-varop'>\\</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span> 
+<a name="line-202"></a><a name="x"></a><span class='hs-definition'>x</span> <span class='hs-varop'>\\</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`intersection`</span> <span class='hs-varid'>complement</span> <span class='hs-varid'>y</span>
+<a name="line-203"></a>
+<a name="line-204"></a><span class='hs-comment'>-- TODO: fix this so that it handles complements correctly</span>
+<a name="line-205"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Eq</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
+<a name="line-206"></a>    <span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>m</span> <span class='hs-keyword'>_</span> <span class='hs-varop'>==</span> <span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l'</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>m'</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>shift</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>l''</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-varid'>shift</span> <span class='hs-varid'>m'</span> <span class='hs-layout'>(</span><span class='hs-varid'>l''</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span> <span class='hs-varid'>l''</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>min</span> <span class='hs-varid'>l</span> <span class='hs-varid'>l'</span>
+<a name="line-207"></a>    <span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>m</span> <span class='hs-keyword'>_</span> <span class='hs-varop'>/=</span> <span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l'</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>m'</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>shift</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>l''</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varop'>/=</span> <span class='hs-varid'>shift</span> <span class='hs-varid'>m'</span> <span class='hs-layout'>(</span><span class='hs-varid'>l''</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span> <span class='hs-varid'>l''</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>min</span> <span class='hs-varid'>l</span> <span class='hs-varid'>l'</span>
+<a name="line-208"></a>
+<a name="line-209"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Ord</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
+<a name="line-210"></a>    <span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>m</span> <span class='hs-keyword'>_</span> <span class='hs-varop'>`compare`</span> <span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l'</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>m'</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>shift</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>l''</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varop'>`compare`</span> <span class='hs-varid'>shift</span> <span class='hs-varid'>m'</span> <span class='hs-layout'>(</span><span class='hs-varid'>l''</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span> <span class='hs-varid'>l''</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>min</span> <span class='hs-varid'>l</span> <span class='hs-varid'>l'</span>
+<a name="line-211"></a>
+<a name="line-212"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Bounded</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
+<a name="line-213"></a>    <span class='hs-varid'>minBound</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
+<a name="line-214"></a>    <span class='hs-varid'>maxBound</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>result</span> <span class='hs-keyword'>where</span>
+<a name="line-215"></a>        <span class='hs-varid'>result</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-varid'>n</span> <span class='hs-varid'>n</span> <span class='hs-varid'>n</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span><span class='hs-varid'>h</span><span class='hs-layout'>)</span>
+<a name="line-216"></a>        <span class='hs-varid'>n</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>h</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l</span> <span class='hs-varop'>+</span> <span class='hs-num'>1</span>
+<a name="line-217"></a>        <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-layout'>(</span><span class='hs-varid'>minBound</span> <span class='hs-varop'>`asArgTypeOf`</span> <span class='hs-varid'>result</span><span class='hs-layout'>)</span>
+<a name="line-218"></a>        <span class='hs-varid'>h</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-layout'>(</span><span class='hs-varid'>maxBound</span> <span class='hs-varop'>`asArgTypeOf`</span> <span class='hs-varid'>result</span><span class='hs-layout'>)</span>
+<a name="line-219"></a>        <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>setBit</span> <span class='hs-num'>0</span> <span class='hs-varid'>n</span> <span class='hs-comment'>-</span> <span class='hs-num'>1</span>
hunk ./doc/html/monoids/src/Data-Ring-Semi-BitSet.html 229
-<a name="line-221"></a><a name="recount"></a><span class='hs-definition'>recount</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
-<a name="line-222"></a><span class='hs-definition'>recount</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recount'</span> <span class='hs-num'>0</span> <span class='hs-keyword'>where</span>
-<a name="line-223"></a>    <span class='hs-varid'>recount'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
-<a name="line-224"></a>    <span class='hs-varid'>recount'</span> <span class='hs-varop'>!</span><span class='hs-varid'>n</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>n</span>
-<a name="line-225"></a>    <span class='hs-varid'>recount'</span> <span class='hs-varop'>!</span><span class='hs-varid'>n</span> <span class='hs-varop'>!</span><span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recount'</span> <span class='hs-layout'>(</span><span class='hs-keyword'>if</span> <span class='hs-varid'>testBit</span> <span class='hs-varid'>m</span> <span class='hs-num'>0</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>n</span><span class='hs-varop'>+</span><span class='hs-num'>1</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>shiftR</span> <span class='hs-varid'>m</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
-<a name="line-226"></a>
-<a name="line-227"></a><span class='hs-comment'>-- note that operations on values generated by toEnum are pretty slow because the bounds are suboptimal</span>
-<a name="line-228"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Enum</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
-<a name="line-229"></a>    <span class='hs-varid'>fromEnum</span> <span class='hs-varid'>b</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>m</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>shiftL</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l'</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
-<a name="line-230"></a>        <span class='hs-keyword'>where</span> 
-<a name="line-231"></a>            <span class='hs-varid'>l'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-layout'>(</span><span class='hs-varid'>minBound</span> <span class='hs-varop'>`asArgTypeOf`</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
-<a name="line-232"></a>    <span class='hs-varid'>toEnum</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>result</span> 
-<a name="line-233"></a>        <span class='hs-keyword'>where</span>
-<a name="line-234"></a>            <span class='hs-varid'>result</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>i</span> <span class='hs-layout'>(</span><span class='hs-varid'>recount</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>undefined</span> <span class='hs-comment'>-- n &lt;= 2^n, so i serves as a valid upper bound</span>
-<a name="line-235"></a>            <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-layout'>(</span><span class='hs-varid'>minBound</span> <span class='hs-varop'>`asArgTypeOf`</span> <span class='hs-varid'>result</span><span class='hs-layout'>)</span>
-<a name="line-236"></a>            <span class='hs-varid'>h</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-layout'>(</span><span class='hs-varid'>maxBound</span> <span class='hs-varop'>`asArgTypeOf`</span> <span class='hs-varid'>result</span><span class='hs-layout'>)</span>
-<a name="line-237"></a>            <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>i</span>
-<a name="line-238"></a>            <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>/=</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>1</span> <span class='hs-comment'>-- allow a fast null check, but not much else</span>
-<a name="line-239"></a>              <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>0</span>
-<a name="line-240"></a>        
-<a name="line-241"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Monoid</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
-<a name="line-242"></a>    <span class='hs-varid'>mempty</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
-<a name="line-243"></a>    <span class='hs-varid'>mappend</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>union</span>
-<a name="line-244"></a>
-<a name="line-245"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Reducer</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
-<a name="line-246"></a>    <span class='hs-varid'>unit</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>singleton</span>
-<a name="line-247"></a>    <span class='hs-varid'>snoc</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>flip</span> <span class='hs-varid'>insert</span>
-<a name="line-248"></a>    <span class='hs-varid'>cons</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>insert</span>
-<a name="line-249"></a>
-<a name="line-250"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Multiplicative</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
-<a name="line-251"></a>    <span class='hs-varid'>one</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>full</span>
-<a name="line-252"></a>    <span class='hs-varid'>times</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>intersection</span>
+<a name="line-221"></a><a name="asArgTypeOf"></a><span class='hs-definition'>asArgTypeOf</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
+<a name="line-222"></a><span class='hs-definition'>asArgTypeOf</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>const</span>
+<a name="line-223"></a><span class='hs-comment'>{-# INLINE asArgTypeOf #-}</span>
+<a name="line-224"></a>
+<a name="line-225"></a><a name="recount"></a><span class='hs-definition'>recount</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
+<a name="line-226"></a><span class='hs-definition'>recount</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recount'</span> <span class='hs-num'>0</span> <span class='hs-keyword'>where</span>
+<a name="line-227"></a>    <span class='hs-varid'>recount'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
+<a name="line-228"></a>    <span class='hs-varid'>recount'</span> <span class='hs-varop'>!</span><span class='hs-varid'>n</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>n</span>
+<a name="line-229"></a>    <span class='hs-varid'>recount'</span> <span class='hs-varop'>!</span><span class='hs-varid'>n</span> <span class='hs-varop'>!</span><span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recount'</span> <span class='hs-layout'>(</span><span class='hs-keyword'>if</span> <span class='hs-varid'>testBit</span> <span class='hs-varid'>m</span> <span class='hs-num'>0</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>n</span><span class='hs-varop'>+</span><span class='hs-num'>1</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>shiftR</span> <span class='hs-varid'>m</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
+<a name="line-230"></a>
+<a name="line-231"></a><span class='hs-comment'>-- note that operations on values generated by toEnum are pretty slow because the bounds are suboptimal</span>
+<a name="line-232"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Enum</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
+<a name="line-233"></a>    <span class='hs-varid'>fromEnum</span> <span class='hs-varid'>b</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>BS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>m</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>shiftL</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span> <span class='hs-comment'>-</span> <span class='hs-varid'>l'</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
+<a name="line-234"></a>        <span class='hs-keyword'>where</span> 
+<a name="line-235"></a>            <span class='hs-varid'>l'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-layout'>(</span><span class='hs-varid'>minBound</span> <span class='hs-varop'>`asArgTypeOf`</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
+<a name="line-236"></a>    <span class='hs-varid'>toEnum</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>result</span> 
+<a name="line-237"></a>        <span class='hs-keyword'>where</span>
+<a name="line-238"></a>            <span class='hs-varid'>result</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BS</span> <span class='hs-varid'>a</span> <span class='hs-varid'>i</span> <span class='hs-layout'>(</span><span class='hs-varid'>recount</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span> <span class='hs-varid'>undefined</span> <span class='hs-comment'>-- n &lt;= 2^n, so i serves as a valid upper bound</span>
+<a name="line-239"></a>            <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-layout'>(</span><span class='hs-varid'>minBound</span> <span class='hs-varop'>`asArgTypeOf`</span> <span class='hs-varid'>result</span><span class='hs-layout'>)</span>
+<a name="line-240"></a>            <span class='hs-varid'>h</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-layout'>(</span><span class='hs-varid'>maxBound</span> <span class='hs-varop'>`asArgTypeOf`</span> <span class='hs-varid'>result</span><span class='hs-layout'>)</span>
+<a name="line-241"></a>            <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>i</span>
+<a name="line-242"></a>            <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>m</span> <span class='hs-varop'>/=</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>1</span> <span class='hs-comment'>-- allow a fast null check, but not much else</span>
+<a name="line-243"></a>              <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>0</span>
+<a name="line-244"></a>        
+<a name="line-245"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Monoid</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
+<a name="line-246"></a>    <span class='hs-varid'>mempty</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
+<a name="line-247"></a>    <span class='hs-varid'>mappend</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>union</span>
+<a name="line-248"></a>
+<a name="line-249"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Reducer</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
+<a name="line-250"></a>    <span class='hs-varid'>unit</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>singleton</span>
+<a name="line-251"></a>    <span class='hs-varid'>snoc</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>flip</span> <span class='hs-varid'>insert</span>
+<a name="line-252"></a>    <span class='hs-varid'>cons</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>insert</span>
hunk ./doc/html/monoids/src/Data-Ring-Semi-BitSet.html 262
-<a name="line-254"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>LeftSemiNearRing</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
-<a name="line-255"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>RightSemiNearRing</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
-<a name="line-256"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>SemiRing</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
+<a name="line-254"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Multiplicative</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
+<a name="line-255"></a>    <span class='hs-varid'>one</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>full</span>
+<a name="line-256"></a>    <span class='hs-varid'>times</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>intersection</span>
hunk ./doc/html/monoids/src/Data-Ring-Semi-BitSet.html 266
-<a name="line-258"></a><span class='hs-comment'>-- idempotent monoid</span>
-<a name="line-259"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>LeftModule</span> <span class='hs-conid'>Natural</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
-<a name="line-260"></a>    <span class='hs-num'>0</span> <span class='hs-varop'>*.</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
-<a name="line-261"></a>    <span class='hs-keyword'>_</span> <span class='hs-varop'>*.</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>m</span>
-<a name="line-262"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>RightModule</span> <span class='hs-conid'>Natural</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
-<a name="line-263"></a>    <span class='hs-keyword'>_</span> <span class='hs-varop'>.*</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
-<a name="line-264"></a>    <span class='hs-varid'>m</span> <span class='hs-varop'>.*</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>m</span>
-<a name="line-265"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Module</span> <span class='hs-conid'>Natural</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
-<a name="line-266"></a>
-<a name="line-267"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>LeftModule</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span> <span class='hs-layout'>(</span><span class='hs-varop'>*.</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>times</span>
-<a name="line-268"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>RightModule</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span> <span class='hs-layout'>(</span><span class='hs-varop'>.*</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>times</span>
-<a name="line-269"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Module</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
+<a name="line-258"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>LeftSemiNearRing</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
+<a name="line-259"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>RightSemiNearRing</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
+<a name="line-260"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>SemiRing</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
+<a name="line-261"></a>
+<a name="line-262"></a><span class='hs-comment'>-- idempotent monoid</span>
+<a name="line-263"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>LeftModule</span> <span class='hs-conid'>Natural</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
+<a name="line-264"></a>    <span class='hs-num'>0</span> <span class='hs-varop'>*.</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
+<a name="line-265"></a>    <span class='hs-keyword'>_</span> <span class='hs-varop'>*.</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>m</span>
+<a name="line-266"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>RightModule</span> <span class='hs-conid'>Natural</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
+<a name="line-267"></a>    <span class='hs-keyword'>_</span> <span class='hs-varop'>.*</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
+<a name="line-268"></a>    <span class='hs-varid'>m</span> <span class='hs-varop'>.*</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>m</span>
+<a name="line-269"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Module</span> <span class='hs-conid'>Natural</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
hunk ./doc/html/monoids/src/Data-Ring-Semi-BitSet.html 279
-<a name="line-271"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Algebra</span> <span class='hs-conid'>Natural</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
-<a name="line-272"></a>    
+<a name="line-271"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>LeftModule</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span> <span class='hs-layout'>(</span><span class='hs-varop'>*.</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>times</span>
+<a name="line-272"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>RightModule</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span> <span class='hs-layout'>(</span><span class='hs-varop'>.*</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>times</span>
+<a name="line-273"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Module</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
+<a name="line-274"></a>
+<a name="line-275"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Algebra</span> <span class='hs-conid'>Natural</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
+<a name="line-276"></a>    
+<a name="line-277"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Generator</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
+<a name="line-278"></a>    <span class='hs-keyword'>type</span> <span class='hs-conid'>Elem</span> <span class='hs-layout'>(</span><span class='hs-conid'>BitSet</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span>
+<a name="line-279"></a>    <span class='hs-varid'>mapReduce</span> <span class='hs-varid'>f</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mapReduce</span> <span class='hs-varid'>f</span> <span class='hs-varop'>.</span> <span class='hs-varid'>toList</span>
}
