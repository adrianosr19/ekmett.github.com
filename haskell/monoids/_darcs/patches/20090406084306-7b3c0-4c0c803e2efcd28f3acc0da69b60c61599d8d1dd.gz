[faster data.set.unboxed hopefully
ekmett@gmail.com**20090406084306
 Ignore-this: c74ea82d86486f02803f04589b89a4f
] {
hunk ./Data/Set/Unboxed.hs 160
-
+    isTip :: USet a -> Bool
+    {-# INLINE isTip #-}
hunk ./Data/Set/Unboxed.hs 171
-    mapReduce _ (view -> Tip) = mempty
+    mapReduce _ (isTip -> True) = mempty
hunk ./Data/Set/Unboxed.hs 200
-null (view -> Tip) = True
hunk ./Data/Set/Unboxed.hs 201
+null _ = True
hunk ./Data/Set/Unboxed.hs 205
-size (view -> Tip) = 0
hunk ./Data/Set/Unboxed.hs 206
+size _ = 0
hunk ./Data/Set/Unboxed.hs 210
-member x (view -> Tip) = False
hunk ./Data/Set/Unboxed.hs 215
+member x _ = False
hunk ./Data/Set/Unboxed.hs 239
-insert x (view -> Tip)          = singleton x
hunk ./Data/Set/Unboxed.hs 243
+insert x _ = singleton x
hunk ./Data/Set/Unboxed.hs 247
-delete x (view -> Tip)         = tip
hunk ./Data/Set/Unboxed.hs 251
+delete x _ = tip
hunk ./Data/Set/Unboxed.hs 258
-isProperSubsetOf s1 s2
-    = (size s1 < size s2) && (isSubsetOf s1 s2)
+isProperSubsetOf s1 s2 = (size s1 < size s2) && (isSubsetOf s1 s2)
hunk ./Data/Set/Unboxed.hs 266
-isSubsetOfX (view -> Tip) _         = True
-isSubsetOfX _ (view -> Tip)         = False
+isSubsetOfX _ (isTip -> True)         = False
hunk ./Data/Set/Unboxed.hs 268
+isSubsetOfX _ _                     = True
hunk ./Data/Set/Unboxed.hs 278
-findMin (view -> Bin _ x (view -> Tip) _) = x
+findMin (view -> Bin _ x (isTip -> True) _) = x
hunk ./Data/Set/Unboxed.hs 280
-findMin (view -> Tip)           = error "Set.findMin: empty set has no minimal element"
+findMin _ = error "Set.findMin: empty set has no minimal element"
hunk ./Data/Set/Unboxed.hs 284
-findMax (view -> Bin _ x _ (view -> Tip))  = x
+findMax (view -> Bin _ x _ (isTip -> True))  = x
hunk ./Data/Set/Unboxed.hs 286
-findMax (view -> Tip)            = error "Set.findMax: empty set has no maximal element"
+findMax _ = error "Set.findMax: empty set has no maximal element"
hunk ./Data/Set/Unboxed.hs 290
-deleteMin (view -> Bin _ _ (view -> Tip) r) = r
+deleteMin (view -> Bin _ _ (isTip -> True) r) = r
hunk ./Data/Set/Unboxed.hs 292
-deleteMin (view -> Tip)           = tip
+deleteMin _ = tip
hunk ./Data/Set/Unboxed.hs 296
-deleteMax (view -> Bin _ _ l (view -> Tip)) = l
+deleteMax (view -> Bin _ _ l (isTip -> True)) = l
hunk ./Data/Set/Unboxed.hs 298
-deleteMax (view -> Tip)           = tip
+deleteMax _ = tip
hunk ./Data/Set/Unboxed.hs 314
-union (view -> Tip) t2  = t2
-union t1 (view -> Tip)  = t1
+union (isTip -> True) t2  = t2
+union t1 (isTip -> True)  = t1
hunk ./Data/Set/Unboxed.hs 319
-hedgeUnion _     _     t1 (view -> Tip)                    = t1
-hedgeUnion cmplo cmphi (view -> Tip) (view -> Bin _ x l r) = join x (filterGt cmplo l) (filterLt cmphi r)
+hedgeUnion _     _     t1 (isTip -> True)                    = t1
+hedgeUnion cmplo cmphi (isTip -> True) (view -> Bin _ x l r) = join x (filterGt cmplo l) (filterLt cmphi r)
hunk ./Data/Set/Unboxed.hs 331
-difference (view -> Tip) _   = tip
-difference t1 (view -> Tip)  = t1
+difference (isTip -> True) _   = tip
+difference t1 (isTip -> True)  = t1
hunk ./Data/Set/Unboxed.hs 336
-hedgeDiff _ _ (view -> Tip) _ = tip
-hedgeDiff cmplo cmphi (view -> Bin _ x l r) (view -> Tip) = join x (filterGt cmplo l) (filterLt cmphi r)
+hedgeDiff _ _ (isTip -> True) _ = tip
+hedgeDiff cmplo cmphi (view -> Bin _ x l r) (isTip -> True) = join x (filterGt cmplo l) (filterLt cmphi r)
hunk ./Data/Set/Unboxed.hs 357
-intersection (view -> Tip) _ = tip
-intersection _ (view -> Tip) = tip
+intersection (isTip -> True) _ = tip
+intersection _ (isTip -> True) = tip
hunk ./Data/Set/Unboxed.hs 378
-filter _ (view -> Tip) = tip
hunk ./Data/Set/Unboxed.hs 381
+filter _ _ = tip
hunk ./Data/Set/Unboxed.hs 387
-partition _ (view -> Tip) = (tip,tip)
hunk ./Data/Set/Unboxed.hs 393
+partition _ _ = (tip,tip)
hunk ./Data/Set/Unboxed.hs 419
-mapMonotonic _ (view -> Tip) = tip
hunk ./Data/Set/Unboxed.hs 420
+mapMonotonic _ _ = tip
hunk ./Data/Set/Unboxed.hs 432
-foldr _ z (view -> Tip)         = z
hunk ./Data/Set/Unboxed.hs 433
+foldr _ z _ = z
hunk ./Data/Set/Unboxed.hs 529
-{-
-XXX unused code
-
-showSet :: (Show a) => [a] -> ShowS
-showSet []     
-  = showString "{}" 
-showSet (x:xs) 
-  = showChar '{' . shows x . showTail xs
-  where
-    showTail []       = showChar '}'
-    showTail (x':xs') = showChar ',' . shows x' . showTail xs'
--}
-
hunk ./Data/Set/Unboxed.hs 577
-trim _     _     (view -> Tip) = tip
hunk ./Data/Set/Unboxed.hs 583
+trim _     _     _ = tip
hunk ./Data/Set/Unboxed.hs 590
-filterGt _ (view -> Tip) = tip
hunk ./Data/Set/Unboxed.hs 595
+filterGt _ _ = tip
hunk ./Data/Set/Unboxed.hs 598
-filterLt _ (view -> Tip) = tip
hunk ./Data/Set/Unboxed.hs 603
+filterLt _ _ = tip
hunk ./Data/Set/Unboxed.hs 613
-split _ (view -> Tip) = (tip,tip)
hunk ./Data/Set/Unboxed.hs 618
+split _ _ = (tip,tip)
hunk ./Data/Set/Unboxed.hs 629
-splitLookup _ (view -> Tip) = (tip,Nothing,tip)
hunk ./Data/Set/Unboxed.hs 634
+splitLookup _ _ = (tip,Nothing,tip)
hunk ./Data/Set/Unboxed.hs 669
-join x (view -> Tip) r  = insertMin x r
-join x l (view -> Tip)  = insertMax x l
+join x (isTip -> True) r  = insertMin x r
+join x l (isTip -> True)  = insertMax x l
hunk ./Data/Set/Unboxed.hs 681
-      Tip -> singleton x
-      Bin _ y l r
-          -> balance y l (insertMax x r)
+      Bin _ y l r -> balance y l (insertMax x r)
+      _ -> singleton x
hunk ./Data/Set/Unboxed.hs 686
-      Tip -> singleton x
-      Bin _ y l r
-          -> balance y (insertMin x l) r
+      Bin _ y l r -> balance y (insertMin x l) r
+      _ -> singleton x
hunk ./Data/Set/Unboxed.hs 693
-merge (view -> Tip) r   = r
-merge l (view -> Tip)   = l
+merge (isTip -> True) r   = r
+merge l (isTip -> True)   = l
hunk ./Data/Set/Unboxed.hs 705
-glue (view -> Tip) r = r
-glue l (view -> Tip) = l
+glue (isTip -> True) r = r
+glue l (isTip -> True) = l
hunk ./Data/Set/Unboxed.hs 719
-      Bin _ x (view -> Tip) r -> (x,r)
+      Bin _ x (isTip -> True) r -> (x,r)
hunk ./Data/Set/Unboxed.hs 729
-      Bin _ x l (view -> Tip) -> (x,l)
+      Bin _ x l (isTip -> True) -> (x,l)
hunk ./Data/Set/Unboxed.hs 731
-      Tip           -> (error "Set.deleteFindMax: can not return the maximal element of an empty set", tip)
+      _ -> (error "Set.deleteFindMax: can not return the maximal element of an empty set", tip)
hunk ./Data/Set/Unboxed.hs 736
-minView (view -> Tip) = Nothing
+minView (isTip -> True) = Nothing
hunk ./Data/Set/Unboxed.hs 742
-maxView (view -> Tip) = Nothing
+maxView (isTip -> True) = Nothing
hunk ./Data/Set/Unboxed.hs 810
-rotateL _ _ (view -> Tip) = error "rotateL Tip"
+rotateL _ _ _ = error "rotateL Tip"
hunk ./Data/Set/Unboxed.hs 816
-rotateR _ (view -> Tip) _ = error "rotateL Tip"
+rotateR _ _ _ = error "rotateL Tip"
hunk ./Data/Set/Unboxed.hs 821
-singleL _  _  (view -> Tip)             = error "singleL"
+singleL _ _ _ = error "singleL"
hunk ./Data/Set/Unboxed.hs 823
-singleR _ (view -> Tip)             _   = error "singleR"
+singleR _ _ _ = error "singleR"
hunk ./Data/Set/Unboxed.hs 904
-      Bin _ x (view -> Tip) (view -> Tip)
+      Bin _ x (isTip -> True) (isTip -> True)
hunk ./Data/Set/Unboxed.hs 917
-      Bin _ x (view -> Tip) (view -> Tip) 
+      Bin _ x (isTip -> True) (isTip -> True) 
hunk ./Data/Set/Unboxed.hs 958
-          Tip         -> True
hunk ./Data/Set/Unboxed.hs 959
+          _ -> True
hunk ./Data/Set/Unboxed.hs 964
-      Tip         -> True
hunk ./Data/Set/Unboxed.hs 966
+      _ -> True
hunk ./Data/Set/Unboxed.hs 974
-          Tip          -> Just 0
hunk ./Data/Set/Unboxed.hs 977
+          _ -> Just 0
hunk ./Data/Set/Unboxed.hs 1153
+    isTip BoxedTip = True
+    isTip _ = False
hunk ./Data/Set/Unboxed.hs 1162
+    isTip CharTip = True
+    isTip _ = False
+
hunk ./Data/Set/Unboxed.hs 1171
+    isTip IntTip = True
+    isTip _ = False
hunk ./Data/Set/Unboxed.hs 1180
+    isTip IntegerTip = True
+    isTip _ = False
hunk ./Data/Set/Unboxed.hs 1189
+    isTip Int8Tip = True
+    isTip _ = False
hunk ./Data/Set/Unboxed.hs 1198
+    isTip Int16Tip = True
+    isTip _ = False
hunk ./Data/Set/Unboxed.hs 1207
+    isTip Int32Tip = True
+    isTip _ = False
hunk ./Data/Set/Unboxed.hs 1216
+    isTip Int64Tip = True
+    isTip _ = False
+
+instance US Word8 where
+    data USet Word8 = Word8Tip | Word8Bin {-# UNPACK #-} !Size {-# UNPACK #-} !Word8 !(USet Word8) !(USet Word8)
+    view Word8Tip = Tip
+    view (Word8Bin s i l r) = Bin s i l r
+    tip = Word8Tip
+    bin = Word8Bin
+    isTip Word8Tip = True
+    isTip _ = False
+
+instance US Word16 where
+    data USet Word16 = Word16Tip | Word16Bin {-# UNPACK #-} !Size {-# UNPACK #-} !Word16 !(USet Word16) !(USet Word16)
+    view Word16Tip = Tip
+    view (Word16Bin s i l r) = Bin s i l r
+    tip = Word16Tip
+    isTip Word16Tip = True
+    isTip _ = False
hunk ./Data/Set/Unboxed.hs 1242
+    isTip Word8Tip = True
+    isTip _ = False
hunk ./Data/Set/Unboxed.hs 1251
+    isTip Word16Tip = True
+    isTip _ = False
hunk ./Data/Set/Unboxed.hs 1260
+    isTip Word32Tip = True
+    isTip _ = False
hunk ./Data/Set/Unboxed.hs 1269
+    isTip Word64Tip = True
+    isTip _ = False
hunk ./Data/Set/Unboxed.hs 1278
+    isTip DoubleTip = True
+    isTip _ = False
hunk ./Data/Set/Unboxed.hs 1287
+    isTip FloatTip = True
+    isTip _ = False
}
