<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/11">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>The Comonad.Reader</title>
	<meta name="generator" content="WordPress 2.8.4" /> <!-- leave this for stats please -->
	<style type="text/css" media="screen">
		@import url( wp-content/themes/connections/style.css );
	</style>	
        <link rel="openid.server" href="https://api.screenname.aol.com/auth/openidServer"/>
        <link rel="openid.delegate" href="http://openid.aol.com/edwardallankmett"/>

	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="feed/index.html" />
	<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="feed/atom/index.html" />
	<link rel="pingback" href="xmlrpc.php.html" />
        <link rel="shortcut icon" href="wp-content/themes/connections/favicon.ico" />
	<!--[if IE]><style type="text/css"> img { behavior: url(pngbehavior/pngbehavior.htc); } </style><![endif]-->
    	<link rel='archives' title='September 2012' href='2012/09/index.html' />
	<link rel='archives' title='August 2012' href='2012/08/index.html' />
	<link rel='archives' title='June 2012' href='2012/06/index.html' />
	<link rel='archives' title='May 2012' href='2012/05/index.html' />
	<link rel='archives' title='April 2012' href='2012/04/index.html' />
	<link rel='archives' title='December 2011' href='2011/12/index.html' />
	<link rel='archives' title='November 2011' href='2011/11/index.html' />
	<link rel='archives' title='October 2011' href='2011/10/index.html' />
	<link rel='archives' title='September 2011' href='2011/09/index.html' />
	<link rel='archives' title='July 2011' href='2011/07/index.html' />
	<link rel='archives' title='June 2011' href='2011/06/index.html' />
	<link rel='archives' title='July 2010' href='2010/07/index.html' />
	<link rel='archives' title='May 2010' href='2010/05/index.html' />
	<link rel='archives' title='April 2010' href='2010/04/index.html' />
	<link rel='archives' title='September 2009' href='2009/09/index.html' />
	<link rel='archives' title='August 2009' href='2009/08/index.html' />
	<link rel='archives' title='July 2009' href='2009/07/index.html' />
	<link rel='archives' title='June 2009' href='2009/06/index.html' />
	<link rel='archives' title='March 2009' href='2009/03/index.html' />
	<link rel='archives' title='December 2008' href='2008/12/index.html' />
	<link rel='archives' title='November 2008' href='2008/11/index.html' />
	<link rel='archives' title='June 2008' href='2008/06/index.html' />
	<link rel='archives' title='May 2008' href='2008/05/index.html' />
	<link rel='archives' title='April 2008' href='2008/04/index.html' />
	<link rel='archives' title='March 2008' href='2008/03/index.html' />
	<link rel='archives' title='January 2008' href='2008/01/index.html' />
	<link rel='archives' title='July 2007' href='2007/07/index.html' />
	<link rel='archives' title='May 2007' href='2007/05/index.html' />
	<link rel='archives' title='November 2006' href='2006/11/index.html' />
	<link rel='archives' title='October 2006' href='2006/10/index.html' />
	<link rel="EditURI" type="application/rsd+xml" title="RSD" href="xmlrpc-rsd.php.html" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='The Comonad.Reader' href='index.html' />
<meta name="generator" content="WordPress 2.8.4" />
</head>

<body>
<div id="rap">
	<div id="header">
	<ul id="topnav">
		<li><a href="index.html" id="navHome" title="Posted Recently" accesskey="h">Home |</a></li>
		<li><a href="about/index.html" id="navAbout" title="About the Author" accesskey="a">About |</a></li>
		<li><a href="source/index-item=libraries.html" id="navSource" title="Source Code" accesskey="s">Source |</a></li>
		<li><a href="mailto:ekmett@gmail.com" id="navContact" title="Contact the Author" accesskey="c">Contact </a></li>
	</ul>
	<a href="index.html" id="logoHome" title="Posted Recently"><img id="logo" src="pngbehavior/blank.gif" ></a>
	<h1><a href="index.html" title="The Comonad.Reader">The Comonad.Reader</a></h1>		
	<div id="desc">types, (co)monads, substructural logic</div>
</div>
	<div id="main">
	<div id="content">
<div id="fpjobs">
<!-- Begin Functional Jobs Affiliate Code -->
<script type="text/javascript" class="fja" src="https://d1ih2qjlwy0iio.cloudfront.net/static/js/affiliates.min.js">
{
	"api_key":"86dec4630f050b0e692605e1e2f90eef",
	"size":"480x60"
}
</script>
<noscript>
	<strong><a href="http://functionaljobs.com">Functional Jobs</a></strong>&mdash;Dream Jobs for Functional Programmers
</noscript>
<!-- End Functional Jobs Affiliate Code -->
</div>
						<div class="post">
				<p class="post-date">Sat 22 Sep 2012</p>
<div class="post-info"><h2 class="post-title"><a href="2012/unnatural-transformations-and-quantifiers/index.html" rel="bookmark" title="Permanent Link: Unnatural Transformations and Quantifiers">Unnatural Transformations and Quantifiers</a></h2>
Posted by Dan Doel under <a href="category/category-theory/index.html" title="View all posts in Category Theory" rel="category tag">Category Theory</a> ,  <a href="category/haskell/index.html" title="View all posts in Haskell" rel="category tag">Haskell</a> ,  <a href="category/kan-extensions/index.html" title="View all posts in Kan Extensions" rel="category tag">Kan Extensions</a> ,  <a href="category/mathematics/index.html" title="View all posts in Mathematics" rel="category tag">Mathematics</a> ,  <a href="category/monads/index.html" title="View all posts in Monads" rel="category tag">Monads</a> <br/><a href="2012/unnatural-transformations-and-quantifiers/index.html#comments" title="Comment on Unnatural Transformations and Quantifiers">[2] Comments</a>&nbsp;</div>
<div class="post-content">
	<p>Recently, a fellow in category land <a href="http://golem.ph.utexas.edu/category/2012/09/where_do_monads_come_from.html">discovered</a> a fact that we in Haskell land have actually known for a while (in addition to things most of us probably don't). Specifically, given two categories <img src='../latex/db5f7b3e9934fbc5a2859d88c4ba84a3.png' title='$\mathcal{C}$' alt='$\mathcal{C}$' align=absmiddle> and <img src='../latex/eaf85f2b753a4c7585def4cc7ecade43.png' title='$\mathcal{D}$' alt='$\mathcal{D}$' align=absmiddle>, a functor <img src='../latex/28408c9aaded61e50623807633e3ce37.png' title='$G : \mathcal{C} \rightarrow \mathcal{D}$' alt='$G : \mathcal{C} \rightarrow \mathcal{D}$' align=absmiddle>, and provided some conditions in <img src='../latex/eaf85f2b753a4c7585def4cc7ecade43.png' title='$\mathcal{D}$' alt='$\mathcal{D}$' align=absmiddle> hold, there exists a monad <img src='../latex/e049fb90e6d941ff5046ca1c48041c8b.png' title='$T^G$' alt='$T^G$' align=absmiddle>, the codensity monad of <img src='../latex/5201385589993766eea584cd3aa6fa13.png' title='$G$' alt='$G$' align=absmiddle>.</p>
<p>In category theory, the codensity monad is given by the rather frightening expression:</p>
<p><img src='../latex/050bb5034bed82159df4c52c89c07f3c.png' title='$ T^G(a) = \int_r \left[\mathcal{D}(a, Gr), Gr\right] $' alt='$ T^G(a) = \int_r \left[\mathcal{D}(a, Gr), Gr\right] $' align=absmiddle></p>
<p>Where the integral notation denotes an <a href="2008/kan-extension-iii/index.html">end</a>, and the square brackets denote a <a href="http://nlab.mathforge.org/nlab/show/power">power</a>, which allows us to take what is essentially an exponential of the objects of <img src='../latex/eaf85f2b753a4c7585def4cc7ecade43.png' title='$\mathcal{D}$' alt='$\mathcal{D}$' align=absmiddle> by objects of <img src='../latex/76105ebc974ce8a02de91bcaf0d6d25f.png' title='$\mathcal{V}$' alt='$\mathcal{V}$' align=absmiddle>, where <img src='../latex/eaf85f2b753a4c7585def4cc7ecade43.png' title='$\mathcal{D}$' alt='$\mathcal{D}$' align=absmiddle> is <a href="http://nlab.mathforge.org/nlab/show/enriched+category">enriched</a> in <img src='../latex/76105ebc974ce8a02de91bcaf0d6d25f.png' title='$\mathcal{V}$' alt='$\mathcal{V}$' align=absmiddle>. Provided the above end exists, <img src='../latex/e049fb90e6d941ff5046ca1c48041c8b.png' title='$T^G$' alt='$T^G$' align=absmiddle> is a monad regardless of whether <img src='../latex/5201385589993766eea584cd3aa6fa13.png' title='$G$' alt='$G$' align=absmiddle> has an <a href="2008/kan-extensions-ii/index.html">adjoint</a>, which is the usual way one thinks of functors (in general) giving rise to monads.</p>
<p>It also turns out that this construction is a sort of generalization of the adjunction case. If we do have <img src='../latex/754907e967821ca061438630f9c72a7d.png' title='$F \dashv G$' alt='$F \dashv G$' align=absmiddle>, this gives rise to a monad <img src='../latex/a095e64d5e4cfbbc3f2bdfd533130212.png' title='$GF$' alt='$GF$' align=absmiddle>. But, in such a case, <img src='../latex/1e0adde1d1e9eba3705ea3cd2880c6f8.png' title='$T^G \cong GF$' alt='$T^G \cong GF$' align=absmiddle>, so the codensity monad is the same as the monad given by the adjunction when it exists, but codensity may exist when there is no adjunction.</p>
<p>In Haskell, this all becomes a bit simpler (to my eyes, at least). Our category <img src='../latex/eaf85f2b753a4c7585def4cc7ecade43.png' title='$\mathcal{D}$' alt='$\mathcal{D}$' align=absmiddle> is always <img src='../latex/129cf6e597bd76a4da1b575b1fa73b20.png' title='$\mathbf{Hask}$' alt='$\mathbf{Hask}$' align=absmiddle>, which is enriched in itself, so powers are just function spaces. And all the functors we write will be rather like <img src='../latex/129cf6e597bd76a4da1b575b1fa73b20.png' title='$\mathbf{Hask}$' alt='$\mathbf{Hask}$' align=absmiddle> (objects will come from kinds we can quantify over), so ends of functors will look like <code>forall r. F r r</code> where <img src='../latex/b075975319f2e91538b5f7f577347d83.png' title='$F : \mathcal{C}^{op} \times \mathcal{C} \rightarrow \mathbf{Hask}$' alt='$F : \mathcal{C}^{op} \times \mathcal{C} \rightarrow \mathbf{Hask}$' align=absmiddle>. Then:<br />
<code><br />
newtype Codensity f a = Codensity (forall r. (a -> f r) -> f r)<br />
</code></p>
<p>As mentioned, we've known for a while that we can write a Monad instance for <code>Codensity f</code> without caring at all about <code>f</code>.</p>
<p>As for the adjunction correspondence, consider the adjunction between products and exponentials: <img src='../latex/179c9a295a34edbdbd4b2f184a62cdc9.png' title='$ - \times S \dashv S \rightarrow - $' alt='$ - \times S \dashv S \rightarrow - $' align=absmiddle></p>
<p>This gives rise to the monad <img src='../latex/4da4a1547d8498791e0069e7616d7040.png' title='$S \rightarrow (- \times S)$' alt='$S \rightarrow (- \times S)$' align=absmiddle>, the state monad. According to the facts above, we should have that <code>Codensity (s ->)</code> (excuse the sectioning) is the same as state, and if we look, we see:<br />
<code><br />
forall r. (a -> s -> r) -> s -> r<br />
</code></p>
<p>which is the continuation passing, or Church (or <a href="http://comments.gmane.org/gmane.comp.lang.haskell.cafe/100508">Boehm-Berarducci</a>) encoding of the monad.</p>
<p>Now, it's also well known that for any monad, we can construct an adjunction that gives rise to it. There are multiple ways to do this, but the most accessible in Haskell is probably via the Kleisli category. So, given a monad <img src='../latex/fb97d38bcc19230b0acd442e17db879c.png' title='$M$' alt='$M$' align=absmiddle> on <img src='../latex/129cf6e597bd76a4da1b575b1fa73b20.png' title='$\mathbf{Hask}$' alt='$\mathbf{Hask}$' align=absmiddle>, there is a category <img src='../latex/a4b150035aa58ceef406ef607d2c3c70.png' title='$\mathbf{Hask}_M$' alt='$\mathbf{Hask}_M$' align=absmiddle> with the same objects, but where <img src='../latex/bc31ad3fd58dd9ca8691a1719354e0fb.png' title='$\mathbf{Hask}_M(a, b) = \mathbf{Hask}(a, Mb)$' alt='$\mathbf{Hask}_M(a, b) = \mathbf{Hask}(a, Mb)$' align=absmiddle>. The identity for each object is <code>return</code> and composition of arrows is:<br />
<code><br />
(f >=> g) x = f x >>= g<br />
</code></p>
<p>Our two functors are:<br />
<code><br />
F a = a<br />
F f = return . f</p>
<p>U a = M a<br />
U f = (>>= f)<br />
</code></p>
<p>Verifying that <img src='../latex/388ff8dfabfc1466d587e51adb83212a.png' title='$F \dashv U$' alt='$F \dashv U$' align=absmiddle> requires only that <img src='../latex/1f96b28abbe86107fdb6e1a8ffe2ea35.png' title='$\mathbf{Hask}_M(F-, =) \cong \mathbf{Hask}(-, U\!\!=)$' alt='$\mathbf{Hask}_M(F-, =) \cong \mathbf{Hask}(-, U\!\!=)$' align=absmiddle>, but this is just <img src='../latex/d29fe5c1dc21ef08d41e2b5f780f1521.png' title='$\mathbf{Hask}(-, M\!\!=) \cong \mathbf{Hask}(-, M\!\!=)$' alt='$\mathbf{Hask}(-, M\!\!=) \cong \mathbf{Hask}(-, M\!\!=)$' align=absmiddle>, which is a triviality. Now we should have that <img src='../latex/bf2765813f7499243599cc3bf3e7f73b.png' title='$T^U = M$' alt='$T^U = M$' align=absmiddle>.</p>
<p>So, one of the simplest monads is reader, <img src='../latex/0b94f1fc58a44d88f75b94e136f017db.png' title='$(e \rightarrow)$' alt='$(e \rightarrow)$' align=absmiddle>. Now, <img src='../latex/6bac6ec50c01592407695ef84f457232.png' title='$U$' alt='$U$' align=absmiddle> just takes objects in the Kleisli category (which are objects in <img src='../latex/129cf6e597bd76a4da1b575b1fa73b20.png' title='$\mathbf{Hask}$' alt='$\mathbf{Hask}$' align=absmiddle>) and applies <img src='../latex/fb97d38bcc19230b0acd442e17db879c.png' title='$M$' alt='$M$' align=absmiddle> to them, so we should have <code>Codensity (e ->)</code> is reader. But earlier we had <code>Codensity (e ->)</code> was state. So reader is state, right?</p>
<p>We can actually arrive at this result another way. One of the most famous pieces of category theory is the <a href="http://blog.sigfpe.com/2006/11/yoneda-lemma.html">Yoneda lemma</a>, which states that the following correspondence holds for any functor <img src='../latex/d15d65be74350891964d514d80d23f4e.png' title='$F : \mathcal{C} \rightarrow \mathbf{Set}$' alt='$F : \mathcal{C} \rightarrow \mathbf{Set}$' align=absmiddle>:</p>
<p><img src='../latex/291bd125d994fd0c7d00a147403dc44e.png' title='$ Fa \,\, \cong \, \mathbf{Set}^\mathcal{C}\left(C(a,-), F\right) $' alt='$ Fa \,\, \cong \, \mathbf{Set}^\mathcal{C}\left(C(a,-), F\right) $' align=absmiddle></p>
<p>This also works for any functor into <img src='../latex/129cf6e597bd76a4da1b575b1fa73b20.png' title='$\mathbf{Hask}$' alt='$\mathbf{Hask}$' align=absmiddle> and looks like:<br />
<code><br />
F a ~= forall r. (a -> r) -> F r<br />
</code></p>
<p>for <img src='../latex/e426801111acba9fcbd11a4bde602af4.png' title='$F : \mathbf{Hask} \rightarrow \mathbf{Hask}$' alt='$F : \mathbf{Hask} \rightarrow \mathbf{Hask}$' align=absmiddle>. But we also have our functor <img src='../latex/d721b9a42081d5f73eec6b96d40c8f87.png' title='$U : \mathbf{Hask}_M \rightarrow \mathbf{Hask}$' alt='$U : \mathbf{Hask}_M \rightarrow \mathbf{Hask}$' align=absmiddle>, which should look more like:</p>
<p><code> U a ~= forall r. (a -> M r) -> U r<br />
M a ~= forall r. (a -> M r) -> M r</code></p>
<p>So, we fill in <code>M = (e ->)</code> and get that reader is isomorphic to state, right? What's going on?</p>
<p>To see, we have to take a closer look at natural transformations. Given two categories <img src='../latex/db5f7b3e9934fbc5a2859d88c4ba84a3.png' title='$\mathcal{C}$' alt='$\mathcal{C}$' align=absmiddle> and <img src='../latex/eaf85f2b753a4c7585def4cc7ecade43.png' title='$\mathcal{D}$' alt='$\mathcal{D}$' align=absmiddle>, and functors <img src='../latex/f9715681e693462be2b2901abbdce20e.png' title='$F, G : \mathcal{C} \rightarrow \mathcal{D}$' alt='$F, G : \mathcal{C} \rightarrow \mathcal{D}$' align=absmiddle>, a natural transformation <img src='../latex/08bda09160c0fde7f63da195d07031c3.png' title='$\phi : F \Rightarrow G$' alt='$\phi : F \Rightarrow G$' align=absmiddle> is a family of maps <img src='../latex/86b3a786efd28fc240d095754564a874.png' title='$\phi_a : Fa \rightarrow Ga$' alt='$\phi_a : Fa \rightarrow Ga$' align=absmiddle> such that for every <img src='../latex/78c2fecc46b4ab88b04b97e64cc513f7.png' title='$f : a \rightarrow b$' alt='$f : a \rightarrow b$' align=absmiddle> the following diagram commutes:</p>
<div style="text-align: center"><img src='../latex/f3b765d571311e2ac37cb7a4d5c849d6.png' title='$ \bfig \square&amp;lt;1000,1000&gt;[Fa`Ga`Fb`Gb;\phi_a`Ff`Gf`\phi_b]\efig $' alt='$ \bfig \square&amp;lt;1000,1000&gt;[Fa`Ga`Fb`Gb;\phi_a`Ff`Gf`\phi_b]\efig $' align=absmiddle></div>
<p>The key piece is what the morphisms look like. It's well known that parametricity ensures the naturality of <code>t :: forall a. F a -> G a</code> for <img src='../latex/764d49adf41244778f7b1f65677bd4ec.png' title='$F, G : \mathbf{Hask} \rightarrow \mathbf{Hask}$' alt='$F, G : \mathbf{Hask} \rightarrow \mathbf{Hask}$' align=absmiddle>, and it also works when the source is <img src='../latex/142c3f0a398b3921283c65dba9b426f6.png' title='$\mathbf{Hask}^{op}$' alt='$\mathbf{Hask}^{op}$' align=absmiddle>. It should also work for a category, call it <img src='../latex/b7581780b90f85bba660172715c3991e.png' title='$\mathbf{Hask}^{\sim}$' alt='$\mathbf{Hask}^{\sim}$' align=absmiddle>, which has Haskell types as objects, but where <img src='../latex/90c1cbbbf7ae5d1def60bc7bd8600cc1.png' title='$\mathbf{Hask}^{\sim}(a, b) = \mathbf{Hask}(a, b) \times \mathbf{Hask}(b, a)$' alt='$\mathbf{Hask}^{\sim}(a, b) = \mathbf{Hask}(a, b) \times \mathbf{Hask}(b, a)$' align=absmiddle>, which is the sort of category that <code>newtype Endo a = Endo (a -> a)</code> is a functor from. So we should be at liberty to say:<br />
<code><br />
Codensity Endo a = forall r. (a -> r -> r) -> r -> r ~= [a]<br />
</code></p>
<p>However, hom types for <img src='../latex/a4b150035aa58ceef406ef607d2c3c70.png' title='$\mathbf{Hask}_M$' alt='$\mathbf{Hask}_M$' align=absmiddle> are not merely made up of <img src='../latex/129cf6e597bd76a4da1b575b1fa73b20.png' title='$\mathbf{Hask}$' alt='$\mathbf{Hask}$' align=absmiddle> hom types on the same arguments, so naturality turns out not to be guaranteed. A functor <img src='../latex/46cde8a293393bfb788e2146a377dfd6.png' title='$F : \mathbf{Hask}_M \rightarrow \mathbf{Hask}$' alt='$F : \mathbf{Hask}_M \rightarrow \mathbf{Hask}$' align=absmiddle> must take a Kleisli arrow <img src='../latex/4f2fe22635b432c01d95ba33d4fc994e.png' title='$f : b \rightarrow Mc$' alt='$f : b \rightarrow Mc$' align=absmiddle> to an arrow <img src='../latex/ec40c947207bed2928a683a7a8014fb7.png' title='$Ff : Fb \rightarrow Fc$' alt='$Ff : Fb \rightarrow Fc$' align=absmiddle>, and transformations must commute with that mapping. So, if we look at our use of Yoneda, we are considering transformations <img src='../latex/47051979f30f700aee1fda6eab3554f3.png' title='$\phi : \mathbf{Hask}_M(a, -) \Rightarrow U$' alt='$\phi : \mathbf{Hask}_M(a, -) \Rightarrow U$' align=absmiddle>:</p>
<div style="text-align: center"><img src='../latex/b2ed6d7df91f89030039a41b41533753.png' title='$ \bfig\square&amp;lt;1000,1000&gt;[\mathbf{Hask}_M(a,b)`Ub`\mathbf{Hask}_M(a,c)`Uc;\phi_a`\mathbf{Hask}_M(a,f)`Uf`\phi_h]\efig $' alt='$ \bfig\square&amp;lt;1000,1000&gt;[\mathbf{Hask}_M(a,b)`Ub`\mathbf{Hask}_M(a,c)`Uc;\phi_a`\mathbf{Hask}_M(a,f)`Uf`\phi_h]\efig $' align=absmiddle></div>
<p>Now, <img src='../latex/7bb5b195ef8bd7e285fdf865d6e658a0.png' title='$\mathbf{Hask}_M(a,b) = \mathbf{Hask}(a, Mb)$' alt='$\mathbf{Hask}_M(a,b) = \mathbf{Hask}(a, Mb)$' align=absmiddle> and <img src='../latex/9c2c2564bc88a3ea51f03f36675984c1.png' title='$Ub = Mb$' alt='$Ub = Mb$' align=absmiddle>. So</p>
<p><code>t :: forall r. (a -> M r) -> M r</code></p>
<p>will get us the right type of maps. But, the above commutative square corresponds to the condition that for all <code>f :: b -> M c</code>:<br />
<code><br />
t . (>=> f) = (>>= f) . t<br />
</code></p>
<p>So, if we have <code>h :: a -> M b</code>, Kleisli composing it with <code>f</code> and then feeding to <code>t</code> is the same as feeding <code>h</code> to <code>t</code> and then binding the result with <code>f</code>.</p>
<p>Now, if we go back to reader, we can consider the reader morphism:<br />
<code><br />
f = const id :: a -> e -> e<br />
</code></p>
<p>For all relevant <code>m</code> and <code>g</code>, <code> m >>= f = id</code> and <code>g >=> f = f</code>. So the<br />
naturality condition here states that <code>t f = id</code>.</p>
<p>Now, <code>t :: forall r. (a -> e -> r) -> e -> r</code>. The general form of these is state actions (I've split <code>e -> (a, e)</code> into two pieces):</p>
<pre language="haskell">
t f e = f (v e) (st e)
  where
  rd :: e -> a
  st :: e -> e
</pre>
<p>If <code>f = const id</code>, then:</p>
<pre language="haskell">
t (const id) e = st e
 where
 st :: e -> e
</pre>
<p>But our naturality condition states that this must be the identity, so we must have <code>st = id</code>. That is, the naturality condition selects <code>t</code> for which the corresponding state action does not change the state, meaning it is equivalent to a reader action! Presumably the definition of an end (which involves dinaturality) enforces a similar condition, although I won't work through it, as it'd be rather more complicated.</p>
<p>However, we have learned a lesson. Quantifiers do not necessarily enforce (di)naturality for every category with objects of the relevant kind. It is important to look at the hom types, not just the objects .In this case, the point of failure seems to be the common, extra <code>s</code>. Even though the type contains nautral transformations for the similar functors over <img src='../latex/129cf6e597bd76a4da1b575b1fa73b20.png' title='$\mathbf{Hask}$' alt='$\mathbf{Hask}$' align=absmiddle>, they can (in general) still manipulate the shared parameter in ways that are not natural for the domain in question.</p>
<p>I am unsure of how exactly one could enforce the above condition in (Haskell's) types. For instance, if we consider:</p>
<p><code>forall r m. Monad m => (a -> m r) -> m r</code></p>
<p>This still contains transformations of the form:</p>
<p><code> t k = k a >> k a </code></p>
<p>And for this to be natural would require:</p>
<p><code> (k >=> f) a >> (k >=> f) a = (k a >> k a) >>= f </code></p>
<p>Which is not true for all possible instantiations of f. It seems as though leaving <code>m</code> unconstrained would be sufficient, as all that could happen is <code>t</code> feeding a value to <code>k</code> and yielding the result, but it seems likely to be over-restrictive.</p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
						<div class="post">
				<p class="post-date">Wed 29 Aug 2012</p>
<div class="post-info"><h2 class="post-title"><a href="2012/hackage-mirror/index.html" rel="bookmark" title="Permanent Link: Working around Hackage Outages">Working around Hackage Outages</a></h2>
Posted by Edward Kmett under <a href="category/haskell/index.html" title="View all posts in Haskell" rel="category tag">Haskell</a> ,  <a href="category/haskell/infrastructure/index.html" title="View all posts in Infrastructure" rel="category tag">Infrastructure</a> <br/><a href="2012/hackage-mirror/index.html#respond" title="Comment on Working around Hackage Outages">No Comments</a>&nbsp;</div>
<div class="post-content">
	<p>Luite Stegeman has a mirror of the packages from <a href="http://hackage.haskell.org/">Hackage</a>.</p>
<p>He uses it to power his incredibly useful <a href="http://hdiff.luite.com">hdiff</a> website.</p>
<p>During a Hackage outage, you can set up your local cabal configuration to point to it instead by (temporarily) replacing the remote-repo in your <code>~/.cabal/config</code> file with:</p>
<p><code><br />
remote-repo:<br />
  hdiff.luite.com:http://hdiff.luite.com/packages/archive<br />
</code></p>
<p>and then running <code>cabal update</code>.</p>
<p>I have a <a href="https://github.com/ekmett/lens/blob/master/config"><code>~/.cabal/config</code></a> that I use whenever hackage goes down in my <a href="https://github.com/ekmett/lens">lens</a> package.</p>
<p>If you use <a href="http://travis-ci.org/">travis-ci</a>, you can avoid build failures during hackage outages by first copying that config to ~/.cabal/config <a href="https://github.com/ekmett/lens/blob/master/.travis.yml#L4">during before_install</a>. -- You'll still be stuck waiting while it first tries to refresh from the real hackage server, but it only adds a few minutes to buildbot times.</p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
						<div class="post">
				<p class="post-date">Sun 24 Jun 2012</p>
<div class="post-info"><h2 class="post-title"><a href="2012/mirrored-lenses/index.html" rel="bookmark" title="Permanent Link: Mirrored Lenses">Mirrored Lenses</a></h2>
Posted by Edward Kmett under <a href="category/algorithms/index.html" title="View all posts in Algorithms" rel="category tag">Algorithms</a> ,  <a href="category/data-structures/index.html" title="View all posts in Data Structures" rel="category tag">Data Structures</a> ,  <a href="category/haskell/index.html" title="View all posts in Haskell" rel="category tag">Haskell</a> ,  <a href="category/lenses/index.html" title="View all posts in Lenses" rel="category tag">Lenses</a> <br/><a href="2012/mirrored-lenses/index.html#comments" title="Comment on Mirrored Lenses">[2] Comments</a>&nbsp;</div>
<div class="post-content">
	<p>Lenses are a great way to deal with functional references, but there are two common issues that arise from their use. </p>
<ol>
<li>There is a long-standing folklore position that lenses do not support polymorphic updates. This has actually caused a fair bit of embarrassment for the folks who'd like to incorporate lenses in any Haskell record system improvement.</li>
<li>Access control. It'd be nice to have read-only or write-only properties -- "one-way" or "mirrored" lenses, as it were. Moreover, lenses are commonly viewed as an all or nothing proposition, in that it is hard to mix them with arbitrary user functions.</li>
<li>Finally there is a bit of a cult around trying to generalize lenses by smashing a monad in the middle of them somewhere, it would be nice to be able to get into a list and work with each individual element in it without worrying about someone mucking up our lens laws, and perhaps avoid the whole generalized lens issue entirely.</li>
</ol>
<p>We'll take a whack at each of these concerns in turn today.<br />
 <a href="2012/mirrored-lenses/index.html#more-600" class="more-link">(more...)</a></p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
						<div class="post">
				<p class="post-date">Sun 10 Jun 2012</p>
<div class="post-info"><h2 class="post-title"><a href="2012/wheres-waldo/index.html" rel="bookmark" title="Permanent Link: Where&#8217;s Waldo?">Where&#8217;s Waldo?</a></h2>
Posted by Edward Kmett under <a href="category/haskell/index.html" title="View all posts in Haskell" rel="category tag">Haskell</a> <br/><a href="2012/wheres-waldo/index.html#respond" title="Comment on Where&#8217;s Waldo?">No Comments</a>&nbsp;</div>
<div class="post-content">
	<p>No, I don't mean like <a href="http://www.optipess.com/2012/05/28/lost-and-found/">this</a>, but rather, If you spent any time trying to figure out xkcd's <a href="http://xkcd.com/1037/">Umwelt</a> April Fool comic this year, you may be interested in the Haskell source code. They used all sorts of information about you, the browser you were using, the resolution of your screen, to the geocoding of the network address you came from, etc. to serve up a custom web comic.</p>
<p>Today, davean posted to github the code for <a href="https://github.com/davean/waldo">waldo</a>, the engine he wrote to drive that comic.</p>
<p>Alas, he was not kind enough to actually supply the code for the umwelt comic strip itself, so you'll still be left wondering if the internet managed to find all of the Easter eggs. (Are they still Easter eggs when you release something a week before Easter?) You may find the list of links below useful if you want to get a feel for the different responses it gave people.</p>
<p>[ <a href="http://www.webpronews.com/xkcd-wins-april-fools-day-with-amazing-changing-comic-gag-2012-04">Article</a> | <a href="http://forums.xkcd.com/viewtopic.php?t=82442">xkcd's Forum</a> | <a href="http://news.ycombinator.com/item?id=3784216">Hacker News</a> | <a href="http://www.reddit.com/r/haskell/comments/roa2k/xkcds_april_1st_joke_this_year_was_written_in/">/r/haskell</a> ]</p>
<p><strong>[Update: Jun 10, 9:09pm]</strong> davean just posted a <a href="http://www.reddit.com/r/haskell/comments/uved7/waldo_the_haskell_powered_codebase_behind_xkcds/">rather insightful post mortem</a> of the development of waldo that talks a bit about why xkcd uses Haskell internally.</p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
						<div class="post">
				<p class="post-date">Sun 27 May 2012</p>
<div class="post-info"><h2 class="post-title"><a href="2012/catamorphism-knol/index.html" rel="bookmark" title="Permanent Link: Catamorphism Knol">Catamorphism Knol</a></h2>
Posted by Edward Kmett under <a href="category/category-theory/index.html" title="View all posts in Category Theory" rel="category tag">Category Theory</a> <br/><a href="2012/catamorphism-knol/index.html#comments" title="Comment on Catamorphism Knol">[4] Comments</a>&nbsp;</div>
<div class="post-content">
	<p>I was contacted by someone who wanted to read my old catamorphism knol, despite the fact that Google Knol is no more. </p>
<p>Fortunately, while it was rather inconvenient that they shut down Google Knol completely, and I'll forever remember a knol as a "unit of abandonment", Google did provide a nice way to download at least your own user content and for that I am grateful.</p>
<p>I have fixed up the internal linkage as much as possible and have placed a copy of the original article below.</p>
<p><a href="../haskell/catamorphisms.html">Catamorphisms: A Knol</a></p>
<p>Sadly, as I am not "Dark Magus", I am unable to download the Russian translation. If anyone knows how to contact him, I would love to obtain and preserve a copy of the translation as well.</p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
						<div class="post">
				<p class="post-date">Mon 2 Apr 2012</p>
<div class="post-info"><h2 class="post-title"><a href="2012/wadlers-law-revisited/index.html" rel="bookmark" title="Permanent Link: Wadler&#8217;s Law Revisited">Wadler&#8217;s Law Revisited</a></h2>
Posted by Edward Kmett under <a href="category/haskell/index.html" title="View all posts in Haskell" rel="category tag">Haskell</a> ,  <a href="category/meta/index.html" title="View all posts in Meta" rel="category tag">Meta</a> <br/><a href="2012/wadlers-law-revisited/index.html#comments" title="Comment on Wadler&#8217;s Law Revisited">[3] Comments</a>&nbsp;</div>
<div class="post-content">
	<p>In light of the burgeoning length of the ongoing record discussion <a href="http://www.haskell.org/pipermail/glasgow-haskell-users/2011-October/021101.html">sparked off by Simon Peyton-Jones in October</a>, I would like to propose that we recognize an extension to Wadler's law (supplied in bold), which I'll refer to as the "Weak Record Conjecture" below.</p>
<blockquote><p>
In any language design, the total time spent discussing a feature in this list is proportional to two raised to the power of its position.</p>
<ul>
<li>0. Semantics</li>
<li>1. Syntax</li>
<li>2. Lexical syntax</li>
<li>3. Lexical syntax of comments</li>
<li><strong>4. Semantics of records</strong></li>
</ul>
</blockquote>
<p> <a href="2012/wadlers-law-revisited/index.html#more-571" class="more-link">(more...)</a></p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
						<div class="post">
				<p class="post-date">Sun 25 Dec 2011</p>
<div class="post-info"><h2 class="post-title"><a href="2011/searching-infinity/index.html" rel="bookmark" title="Permanent Link: Searching Infinity Parametrically">Searching Infinity Parametrically</a></h2>
Posted by Edward Kmett under <a href="category/algorithms/index.html" title="View all posts in Algorithms" rel="category tag">Algorithms</a> ,  <a href="category/haskell/index.html" title="View all posts in Haskell" rel="category tag">Haskell</a> ,  <a href="category/kan-extensions/index.html" title="View all posts in Kan Extensions" rel="category tag">Kan Extensions</a> ,  <a href="category/logic/index.html" title="View all posts in Logic" rel="category tag">Logic</a> ,  <a href="category/mathematics/index.html" title="View all posts in Mathematics" rel="category tag">Mathematics</a> ,  <a href="category/monads/index.html" title="View all posts in Monads" rel="category tag">Monads</a> ,  <a href="category/type-hackery/index.html" title="View all posts in Type Hackery" rel="category tag">Type Hackery</a> <br/><a href="2011/searching-infinity/index.html#comments" title="Comment on Searching Infinity Parametrically">[11] Comments</a>&nbsp;</div>
<div class="post-content">
	<p>Andrej Bauer recently gave a really nice talk on how you can exploit side-effects to make a faster version of Martin Escardo's pseudo-paradoxical combinators. </p>
<p><a href="http://math.andrej.com/2011/12/06/how-to-make-the-impossible-functionals-run-even-faster/">A video of his talk is available over on his blog</a>, and his presentation is remarkably clear, and would serve as a good preamble to the code I'm going to present below.</p>
<p>Andrej gave a related invited talk back at <a href="http://msfp.org.uk/">MSFP 2008</a> in Iceland, and afterwards over lunch I cornered him (with Dan Piponi) and explained how you could use parametricity to close over the side-effects of monads (or arrows, etc) but I think that trick was lost in the chaos of the weekend, so I've chosen to resurrect it here, and improve it to handle some of his more recent performance enhancements, and show that you don't need side-effects to speed up the search after all!</p>
<p> <a href="2011/searching-infinity/index.html#more-510" class="more-link">(more...)</a></p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
						<div class="post">
				<p class="post-date">Thu 3 Nov 2011</p>
<div class="post-info"><h2 class="post-title"><a href="2011/what-constraints-entail-part-2/index.html" rel="bookmark" title="Permanent Link: What Constraints Entail: Part 2">What Constraints Entail: Part 2</a></h2>
Posted by Edward Kmett under <a href="category/haskell/constraint-kinds/index.html" title="View all posts in Constraint Kinds" rel="category tag">Constraint Kinds</a> ,  <a href="category/haskell/index.html" title="View all posts in Haskell" rel="category tag">Haskell</a> ,  <a href="category/logic/index.html" title="View all posts in Logic" rel="category tag">Logic</a> ,  <a href="category/monads/index.html" title="View all posts in Monads" rel="category tag">Monads</a> ,  <a href="category/type-hackery/index.html" title="View all posts in Type Hackery" rel="category tag">Type Hackery</a> ,  <a href="category/uncategorized/index.html" title="View all posts in Uncategorized" rel="category tag">Uncategorized</a> <br/><a href="2011/what-constraints-entail-part-2/index.html#comments" title="Comment on What Constraints Entail: Part 2">[13] Comments</a>&nbsp;</div>
<div class="post-content">
	<p><a href="2011/what-constraints-entail-part-1/index.html">Last time</a> we derived an entailment relation for constraints, now let's get some use out of it.</p>
<h2>Reflecting Classes and Instances</h2>
<p>Most of the implications we use on a day to day basis come from our class and instance declarations, but last time we only really dealt with constraint products.</p>
<p> <a href="2011/what-constraints-entail-part-2/index.html#more-461" class="more-link">(more...)</a></p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
						<div class="post">
				<p class="post-date">Thu 3 Nov 2011</p>
<div class="post-info"><h2 class="post-title"><a href="2011/what-constraints-entail-part-1/index.html" rel="bookmark" title="Permanent Link: What Constraints Entail: Part 1">What Constraints Entail: Part 1</a></h2>
Posted by Edward Kmett under <a href="category/category-theory/index.html" title="View all posts in Category Theory" rel="category tag">Category Theory</a> ,  <a href="category/haskell/constraint-kinds/index.html" title="View all posts in Constraint Kinds" rel="category tag">Constraint Kinds</a> ,  <a href="category/haskell/index.html" title="View all posts in Haskell" rel="category tag">Haskell</a> ,  <a href="category/logic/index.html" title="View all posts in Logic" rel="category tag">Logic</a> ,  <a href="category/monads/index.html" title="View all posts in Monads" rel="category tag">Monads</a> ,  <a href="category/type-hackery/index.html" title="View all posts in Type Hackery" rel="category tag">Type Hackery</a> ,  <a href="category/uncategorized/index.html" title="View all posts in Uncategorized" rel="category tag">Uncategorized</a> <br/><a href="2011/what-constraints-entail-part-1/index.html#comments" title="Comment on What Constraints Entail: Part 1">[4] Comments</a>&nbsp;</div>
<div class="post-content">
	<p>Max Bolingbroke has done a wonderful job on adding Constraint kinds to GHC.</p>
<p>Constraint Kinds adds a new kind <code>Constraint</code>, such that <code>Eq :: * -> Constraint</code>, <code>Monad :: (* -> *) -> Constraint</code>, but since it is a kind, we can make type families for constraints, and even parameterize constraints <em>on</em> constraints. </p>
<p>So, let's play with them and see what we can come up with!</p>
<p> <a href="2011/what-constraints-entail-part-1/index.html#more-430" class="more-link">(more...)</a></p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
						<div class="post">
				<p class="post-date">Thu 27 Oct 2011</p>
<div class="post-info"><h2 class="post-title"><a href="2011/homotopy-and-directed-type-theory-slides/index.html" rel="bookmark" title="Permanent Link: Homotopy and Directed Type Theory Slides">Homotopy and Directed Type Theory Slides</a></h2>
Posted by Edward Kmett under <a href="category/haskell/boston-haskell/index.html" title="View all posts in Boston Haskell" rel="category tag">Boston Haskell</a> ,  <a href="category/category-theory/index.html" title="View all posts in Category Theory" rel="category tag">Category Theory</a> ,  <a href="category/haskell/index.html" title="View all posts in Haskell" rel="category tag">Haskell</a> ,  <a href="category/type-theory/index.html" title="View all posts in Type Theory" rel="category tag">Type Theory</a> <br/><a href="2011/homotopy-and-directed-type-theory-slides/index.html#respond" title="Comment on Homotopy and Directed Type Theory Slides">No Comments</a>&nbsp;</div>
<div class="post-content">
	<p>As requested, here are the slides from Dan Doel's excellent presentation on <a href='wp-content/uploads/2011/10/slides.pdf'>Homotopy and Directed Type Theory</a> from this past Monday's <a href="http://groups.google.com/group/bostonhaskell/browse_thread/thread/9892caece9ebb4d4">Boston Haskell</a>.</p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
						<div class="post">
				<p class="post-date">Tue 25 Oct 2011</p>
<div class="post-info"><h2 class="post-title"><a href="2011/hac-boston/index.html" rel="bookmark" title="Permanent Link: Hac Boston!">Hac Boston!</a></h2>
Posted by Edward Kmett under <a href="category/haskell/boston-haskell/index.html" title="View all posts in Boston Haskell" rel="category tag">Boston Haskell</a> ,  <a href="category/haskell/boston-haskell/hac-boston/index.html" title="View all posts in Hac Boston" rel="category tag">Hac Boston</a> ,  <a href="category/haskell/index.html" title="View all posts in Haskell" rel="category tag">Haskell</a> <br/><a href="2011/hac-boston/index.html#respond" title="Comment on Hac Boston!">No Comments</a>&nbsp;</div>
<div class="post-content">
	<p>I am very pleased to officially announce Hac Boston, a Haskell hackathon to be held January 20-22, 2012 at MIT in Cambridge, MA.  The hackathon will officially kick off at 2:30 Friday afternoon, and go until 5pm on Sunday with the occasional break for sleep.  </p>
<p>Everyone is welcome -- you do not have to be a Haskell guru to attend!  Helping hack on someone else's project could be a great way to increase your Haskell skills.</p>
<p>If you plan on coming, <a href="http://haskell.org/haskellwiki/Hac_Boston/Register">please officially register</a>, even if you already put your name on the wiki.  Registration, travel, some information about lodging and many other details can now be found on the <a href="http://haskell.org/haskellwiki/Hac_Boston">Hac Boston wiki</a>.</p>
<p>We have confirmed space for about 30 people, so please register early! Beyond that we'll have to either seek additional space or close registration.</p>
<p>We're also looking for a few people interested in giving short (15-20 min.) talks, probably on Saturday afternoon.  Anything of interest to the Haskell community is fair game---a project you've been working on, a paper, a quick tutorial.  If you'd like to give a talk, <a href="http://haskell.org/haskellwiki/Hac_Boston/Talks">add it on the wiki</a>.</p>
<p>We look forward to seeing you at MIT!</p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
						<div class="post">
				<p class="post-date">Fri 23 Sep 2011</p>
<div class="post-info"><h2 class="post-title"><a href="2011/a-parsec-full-of-rats-part-2/index.html" rel="bookmark" title="Permanent Link: A Parsec Full of Rats, Part 2">A Parsec Full of Rats, Part 2</a></h2>
Posted by Edward Kmett under <a href="category/algorithms/index.html" title="View all posts in Algorithms" rel="category tag">Algorithms</a> ,  <a href="category/data-structures/index.html" title="View all posts in Data Structures" rel="category tag">Data Structures</a> ,  <a href="category/haskell/index.html" title="View all posts in Haskell" rel="category tag">Haskell</a> ,  <a href="category/monads/index.html" title="View all posts in Monads" rel="category tag">Monads</a> ,  <a href="category/parsing/index.html" title="View all posts in Parsing" rel="category tag">Parsing</a> ,  <a href="category/uncategorized/index.html" title="View all posts in Uncategorized" rel="category tag">Uncategorized</a> <br/><a href="2011/a-parsec-full-of-rats-part-2/index.html#respond" title="Comment on A Parsec Full of Rats, Part 2">No Comments</a>&nbsp;</div>
<div class="post-content">
	<p>Last time, I showed that we can build a small parsec clone with packrat support.</p>
<p>This time I intend to implement packrat directly on top of Parsec 3.</p>
<p>One of the main topics of discussion when it comes to packrat parsing since Bryan Ford's initial release of Pappy has been the fact that in general you shouldn't use packrat to memoize every rule, and that instead you should apply Amdahl's law to look for the cases where the lookup time is paid back in terms of repetitive evaluation, computation time and the hit rate. This is great news for us, since, we only want to memoize a handful of expensive combinators.</p>
<p> <a href="2011/a-parsec-full-of-rats-part-2/index.html#more-397" class="more-link">(more...)</a></p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
						<div class="post">
				<p class="post-date">Fri 23 Sep 2011</p>
<div class="post-info"><h2 class="post-title"><a href="2011/a-parsec-full-of-rats/index.html" rel="bookmark" title="Permanent Link: A Parsec Full of Rats, Part 1">A Parsec Full of Rats, Part 1</a></h2>
Posted by Edward Kmett under <a href="category/algorithms/index.html" title="View all posts in Algorithms" rel="category tag">Algorithms</a> ,  <a href="category/data-structures/index.html" title="View all posts in Data Structures" rel="category tag">Data Structures</a> ,  <a href="category/haskell/index.html" title="View all posts in Haskell" rel="category tag">Haskell</a> ,  <a href="category/monads/index.html" title="View all posts in Monads" rel="category tag">Monads</a> ,  <a href="category/parsing/index.html" title="View all posts in Parsing" rel="category tag">Parsing</a> ,  <a href="category/uncategorized/index.html" title="View all posts in Uncategorized" rel="category tag">Uncategorized</a> <br/><a href="2011/a-parsec-full-of-rats/index.html#comments" title="Comment on A Parsec Full of Rats, Part 1">[2] Comments</a>&nbsp;</div>
<div class="post-content">
	<blockquote><p>You never heard of the Millenium Falcon? It's the ship that made the Kessel Run in 12 parsecs.</p></blockquote>
<p>I've been working on a parser combinator library called <a href="http://hackage.haskell.org/package/trifecta">trifecta</a>, and so I decided I'd share some thoughts on parsing. </p>
<p><a href="http://pdos.csail.mit.edu/~baford/packrat/">Packrat parsing</a> (as provided by <a href="http://hackage.haskell.org/package/frisby">frisby</a>, <a href="http://hackage.haskell.org/package/pappy">pappy</a>, <a href="http://cs.nyu.edu/rgrimm/xtc/">rats!</a> and the Scala parsing combinators) and more traditional recursive descent parsers (like Parsec) are often held up as somehow different. </p>
<p>Today I'll show that you can add monadic parsing to a packrat parser, sacrificing asymptotic guarantees in exchange for the convenient context sensitivity, and conversely how you can easily add packrat parsing to a traditional monadic parser combinator library.</p>
<p> <a href="2011/a-parsec-full-of-rats/index.html#more-380" class="more-link">(more...)</a></p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
						<div class="post">
				<p class="post-date">Mon 11 Jul 2011</p>
<div class="post-info"><h2 class="post-title"><a href="2011/free-modules-and-functional-linear-functionals/index.html" rel="bookmark" title="Permanent Link: Free Modules and Functional Linear Functionals">Free Modules and Functional Linear Functionals</a></h2>
Posted by Edward Kmett under <a href="category/algorithms/index.html" title="View all posts in Algorithms" rel="category tag">Algorithms</a> ,  <a href="category/category-theory/index.html" title="View all posts in Category Theory" rel="category tag">Category Theory</a> ,  <a href="category/data-structures/index.html" title="View all posts in Data Structures" rel="category tag">Data Structures</a> ,  <a href="category/haskell/index.html" title="View all posts in Haskell" rel="category tag">Haskell</a> ,  <a href="category/mathematics/linear-algebra/index.html" title="View all posts in Linear Algebra" rel="category tag">Linear Algebra</a> ,  <a href="category/monads/index.html" title="View all posts in Monads" rel="category tag">Monads</a> ,  <a href="category/monoids/index.html" title="View all posts in Monoids" rel="category tag">Monoids</a> ,  <a href="category/type-hackery/index.html" title="View all posts in Type Hackery" rel="category tag">Type Hackery</a> <br/><a href="2011/free-modules-and-functional-linear-functionals/index.html#comments" title="Comment on Free Modules and Functional Linear Functionals">[9] Comments</a>&nbsp;</div>
<div class="post-content">
	<p>Today I hope to start a new series of posts exploring constructive abstract algebra in Haskell.  </p>
<p>In particular, I want to talk about a novel encoding of linear functionals, polynomials and linear maps in Haskell, but first we're going to have to build up some common terminology.</p>
<p>Having obtained the blessing of Wolfgang Jeltsch, I replaced the <a href="http://hackage.haskell.org/package/algebra">algebra</a> package on hackage with something... bigger, although still very much a work in progress.</p>
<p> <a href="2011/free-modules-and-functional-linear-functionals/index.html#more-356" class="more-link">(more...)</a></p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
						<div class="post">
				<p class="post-date">Thu 30 Jun 2011</p>
<div class="post-info"><h2 class="post-title"><a href="2011/a-product-of-an-imperfect-union/index.html" rel="bookmark" title="Permanent Link: A Product of an Imperfect Union">A Product of an Imperfect Union</a></h2>
Posted by Edward Kmett under <a href="category/category-theory/index.html" title="View all posts in Category Theory" rel="category tag">Category Theory</a> ,  <a href="category/comonads/index.html" title="View all posts in Comonads" rel="category tag">Comonads</a> ,  <a href="category/haskell/index.html" title="View all posts in Haskell" rel="category tag">Haskell</a> ,  <a href="category/kan-extensions/index.html" title="View all posts in Kan Extensions" rel="category tag">Kan Extensions</a> ,  <a href="category/monads/index.html" title="View all posts in Monads" rel="category tag">Monads</a> <br/><a href="2011/a-product-of-an-imperfect-union/index.html#respond" title="Comment on A Product of an Imperfect Union">No Comments</a>&nbsp;</div>
<div class="post-content">
	<p>In the last few posts, I've been talking about how we can derive <a href="2011/monads-from-comonads/index.html">monads</a> and <a href="2011/monad-transformers-from-comonads/index.html">monad transformers</a> from comonads. Along the way we learned that there are more monads than comonads in Haskell.</p>
<p>The question I hope to answer this time, is whether or not we turn any Haskell <code>Comonad</code> into a <a href="http://hackage.haskell.org/packages/archive/comonad-transformers/1.8.0/doc/html/Control-Comonad-Trans-Class.html">comonad transformer</a>.</p>
<p> <a href="2011/a-product-of-an-imperfect-union/index.html#more-337" class="more-link">(more...)</a></p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
						<div class="post">
				<p class="post-date">Thu 30 Jun 2011</p>
<div class="post-info"><h2 class="post-title"><a href="2011/more-on-comonads-as-monad-transformers/index.html" rel="bookmark" title="Permanent Link: More on Comonads as Monad Transformers">More on Comonads as Monad Transformers</a></h2>
Posted by Edward Kmett under <a href="category/category-theory/index.html" title="View all posts in Category Theory" rel="category tag">Category Theory</a> ,  <a href="category/comonads/index.html" title="View all posts in Comonads" rel="category tag">Comonads</a> ,  <a href="category/haskell/index.html" title="View all posts in Haskell" rel="category tag">Haskell</a> ,  <a href="category/kan-extensions/index.html" title="View all posts in Kan Extensions" rel="category tag">Kan Extensions</a> ,  <a href="category/monads/index.html" title="View all posts in Monads" rel="category tag">Monads</a> <br/><a href="2011/more-on-comonads-as-monad-transformers/index.html#comments" title="Comment on More on Comonads as Monad Transformers">[3] Comments</a>&nbsp;</div>
<div class="post-content">
	<p>Last time in <a href="2011/monad-transformers-from-comonads/index.html">Monad Transformers from Comonads</a> I showed that given any comonad we can derive the monad-transformer</p>
<pre class="haskell">&nbsp;
<span style="color: #06c; font-weight: bold;">newtype</span> CoT w m a = CoT <span style="color: green;">&#123;</span> runCoT :: w <span style="color: green;">&#40;</span>a -&gt; m r<span style="color: green;">&#41;</span> -&gt; m r
&nbsp;</pre>
<p>and so demonstrated that there are fewer comonads than monads in Haskell, because while every Comonad gives rise to a Monad transformer, there are Monads that do not like <code>IO</code>, <code>ST s</code>, and <code>STM</code>.</p>
<p>I want to elaborate a bit more on this topic.</p>
<p> <a href="2011/more-on-comonads-as-monad-transformers/index.html#more-328" class="more-link">(more...)</a></p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
						<div class="post">
				<p class="post-date">Tue 28 Jun 2011</p>
<div class="post-info"><h2 class="post-title"><a href="2011/monad-transformers-from-comonads/index.html" rel="bookmark" title="Permanent Link: Monad Transformers from Comonads">Monad Transformers from Comonads</a></h2>
Posted by Edward Kmett under <a href="category/category-theory/index.html" title="View all posts in Category Theory" rel="category tag">Category Theory</a> ,  <a href="category/comonads/index.html" title="View all posts in Comonads" rel="category tag">Comonads</a> ,  <a href="category/data-structures/index.html" title="View all posts in Data Structures" rel="category tag">Data Structures</a> ,  <a href="category/haskell/index.html" title="View all posts in Haskell" rel="category tag">Haskell</a> ,  <a href="category/kan-extensions/index.html" title="View all posts in Kan Extensions" rel="category tag">Kan Extensions</a> ,  <a href="category/monads/index.html" title="View all posts in Monads" rel="category tag">Monads</a> <br/><a href="2011/monad-transformers-from-comonads/index.html#comments" title="Comment on Monad Transformers from Comonads">1 Comment</a>&nbsp;</div>
<div class="post-content">
	<p><a href="2011/monads-from-comonads/index.html">Last time</a>, I showed that we can transform any Comonad in Haskell into a Monad in Haskell.</p>
<p>Today, I'll show that we can go one step further and derive a monad transformer from any comonad! </p>
<p> <a href="2011/monad-transformers-from-comonads/index.html#more-321" class="more-link">(more...)</a></p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
						<div class="post">
				<p class="post-date">Mon 27 Jun 2011</p>
<div class="post-info"><h2 class="post-title"><a href="2011/monads-from-comonads/index.html" rel="bookmark" title="Permanent Link: Monads from Comonads">Monads from Comonads</a></h2>
Posted by Edward Kmett under <a href="category/category-theory/index.html" title="View all posts in Category Theory" rel="category tag">Category Theory</a> ,  <a href="category/comonads/index.html" title="View all posts in Comonads" rel="category tag">Comonads</a> ,  <a href="category/haskell/index.html" title="View all posts in Haskell" rel="category tag">Haskell</a> ,  <a href="category/kan-extensions/index.html" title="View all posts in Kan Extensions" rel="category tag">Kan Extensions</a> ,  <a href="category/mathematics/index.html" title="View all posts in Mathematics" rel="category tag">Mathematics</a> ,  <a href="category/monads/index.html" title="View all posts in Monads" rel="category tag">Monads</a> <br/><a href="2011/monads-from-comonads/index.html#comments" title="Comment on Monads from Comonads">[9] Comments</a>&nbsp;</div>
<div class="post-content">
	<p>Today I'll show that you can derive a <code>Monad</code> from any old <code>Comonad</code> you have lying around.</p>
<p> <a href="2011/monads-from-comonads/index.html#more-291" class="more-link">(more...)</a></p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
						<div class="post">
				<p class="post-date">Fri 24 Jun 2011</p>
<div class="post-info"><h2 class="post-title"><a href="2011/free-monads-for-less-3/index.html" rel="bookmark" title="Permanent Link: Free Monads for Less (Part 3 of 3): Yielding IO">Free Monads for Less (Part 3 of 3): Yielding IO</a></h2>
Posted by Edward Kmett under <a href="category/algorithms/index.html" title="View all posts in Algorithms" rel="category tag">Algorithms</a> ,  <a href="category/category-theory/index.html" title="View all posts in Category Theory" rel="category tag">Category Theory</a> ,  <a href="category/comonads/index.html" title="View all posts in Comonads" rel="category tag">Comonads</a> ,  <a href="category/data-structures/index.html" title="View all posts in Data Structures" rel="category tag">Data Structures</a> ,  <a href="category/haskell/index.html" title="View all posts in Haskell" rel="category tag">Haskell</a> ,  <a href="category/kan-extensions/index.html" title="View all posts in Kan Extensions" rel="category tag">Kan Extensions</a> ,  <a href="category/monads/index.html" title="View all posts in Monads" rel="category tag">Monads</a> <br/><a href="2011/free-monads-for-less-3/index.html#comments" title="Comment on Free Monads for Less (Part 3 of 3): Yielding IO">[9] Comments</a>&nbsp;</div>
<div class="post-content">
	<p><a href="2011/free-monads-for-less-2/index.html">Last time</a>, I said that I was going to put our cheap new free monad to work, so let's give it a shot. </p>
<p> <a href="2011/free-monads-for-less-3/index.html#more-251" class="more-link">(more...)</a></p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
						<div class="post">
				<p class="post-date">Thu 23 Jun 2011</p>
<div class="post-info"><h2 class="post-title"><a href="2011/free-monads-for-less-2/index.html" rel="bookmark" title="Permanent Link: Free Monads for Less (Part 2 of 3): Yoneda">Free Monads for Less (Part 2 of 3): Yoneda</a></h2>
Posted by Edward Kmett under <a href="category/algorithms/index.html" title="View all posts in Algorithms" rel="category tag">Algorithms</a> ,  <a href="category/category-theory/index.html" title="View all posts in Category Theory" rel="category tag">Category Theory</a> ,  <a href="category/data-structures/index.html" title="View all posts in Data Structures" rel="category tag">Data Structures</a> ,  <a href="category/haskell/index.html" title="View all posts in Haskell" rel="category tag">Haskell</a> ,  <a href="category/kan-extensions/index.html" title="View all posts in Kan Extensions" rel="category tag">Kan Extensions</a> ,  <a href="category/mathematics/index.html" title="View all posts in Mathematics" rel="category tag">Mathematics</a> ,  <a href="category/monads/index.html" title="View all posts in Monads" rel="category tag">Monads</a> <br/><a href="2011/free-monads-for-less-2/index.html#comments" title="Comment on Free Monads for Less (Part 2 of 3): Yoneda">[3] Comments</a>&nbsp;</div>
<div class="post-content">
	<p><a href="2011/free-monads-for-less/index.html">Last time</a>, I started exploring whether or not <a href="http://hackage.haskell.org/packages/archive/kan-extensions/0.5.0/doc/html/Control-Monad-Codensity.html">Codensity</a> was necessary to <a href="http://www.iai.uni-bonn.de/~jv/mpc08.pdf">improve the asymptotic performance of free monads</a>.</p>
<p>This time I'll show that the answer is no; we can get by with something smaller.</p>
<p> <a href="2011/free-monads-for-less-2/index.html#more-243" class="more-link">(more...)</a></p>
	<div class="post-info">
			</div>
	<div class="post-footer">&nbsp;</div>
</div>
							</div>
					<p align="center"><a href="page/2/index.html" >Next Page &raquo;</a></p>		
	</div>
	<div id="sidebar">
<h2>About</h2>
<ul><li><div align="center">
<script language="JavaScript" type="text/javascript" src="http://www.linkedinabox.com/inabox.js"></script>
<script language="JavaScript" type="text/javascript">createInABox('160', '274', '10285663', 'Edward Kmett',1,'undefined');</script>
</div></li></ul>
		
		
		<h2>Wiki</h2>
<ul>
    <li><a href="wiki/index-item=October%202006_August%202006_July%202006.html">Old Journal</a></li>
    <li><a href="source/index-item=libraries.html">Source</a>
    <li><a href="wiki/index-item=Harmless+Algorithms_fine-occlusion+culling.html">Harmless Algorithms</a></li>
</ul>
<!--
<h2>Pages</h2>
<ul><li class="page_item page-item-2"><a href="http://comonad.com/reader/about/" title="About">About</a></li>
<li class="page_item page-item-29"><a href="http://comonad.com/reader/source/" title="Source">Source</a></li>
<li class="page_item page-item-31"><a href="http://comonad.com/reader/wiki-category/" title="View Category">View Category</a></li>
<li class="page_item page-item-30"><a href="http://comonad.com/reader/wiki/" title="Wiki">Wiki</a></li>
</ul>
-->
<!--
<h2>Blog Topics</h2>
<ul>	<li class="cat-item cat-item-29"><a href="http://comonad.com/reader/category/algorithms/" title="View all posts filed under Algorithms">Algorithms</a> (13)
</li>
	<li class="cat-item cat-item-22"><a href="http://comonad.com/reader/category/category-theory/" title="View all posts filed under Category Theory">Category Theory</a> (31)
</li>
	<li class="cat-item cat-item-23"><a href="http://comonad.com/reader/category/comonads/" title="View all posts filed under Comonads">Comonads</a> (16)
</li>
	<li class="cat-item cat-item-28"><a href="http://comonad.com/reader/category/data-structures/" title="View all posts filed under Data Structures">Data Structures</a> (12)
</li>
	<li class="cat-item cat-item-15"><a href="http://comonad.com/reader/category/haskell/" title="View all posts filed under Haskell">Haskell</a> (57)
<ul class='children'>
	<li class="cat-item cat-item-34"><a href="http://comonad.com/reader/category/haskell/boston-haskell/" title="View all posts filed under Boston Haskell">Boston Haskell</a> (6)
	<ul class='children'>
	<li class="cat-item cat-item-42"><a href="http://comonad.com/reader/category/haskell/boston-haskell/hac-boston/" title="View all posts filed under Hac Boston">Hac Boston</a> (1)
</li>
	</ul>
</li>
	<li class="cat-item cat-item-43"><a href="http://comonad.com/reader/category/haskell/constraint-kinds/" title="View all posts filed under Constraint Kinds">Constraint Kinds</a> (2)
</li>
	<li class="cat-item cat-item-52"><a href="http://comonad.com/reader/category/haskell/infrastructure/" title="View all posts filed under Infrastructure">Infrastructure</a> (1)
</li>
</ul>
</li>
	<li class="cat-item cat-item-20"><a href="http://comonad.com/reader/category/javascript/" title="View all posts filed under Javascript">Javascript</a> (1)
</li>
	<li class="cat-item cat-item-27"><a href="http://comonad.com/reader/category/kan-extensions/" title="View all posts filed under Kan Extensions">Kan Extensions</a> (12)
</li>
	<li class="cat-item cat-item-47"><a href="http://comonad.com/reader/category/lenses/" title="View all posts filed under Lenses">Lenses</a> (1)
</li>
	<li class="cat-item cat-item-13"><a href="http://comonad.com/reader/category/logic/" title="View all posts filed under Logic">Logic</a> (4)
</li>
	<li class="cat-item cat-item-33"><a href="http://comonad.com/reader/category/macros/" title="View all posts filed under Macros">Macros</a> (1)
</li>
	<li class="cat-item cat-item-25"><a href="http://comonad.com/reader/category/mathematics/" title="View all posts filed under Mathematics">Mathematics</a> (15)
<ul class='children'>
	<li class="cat-item cat-item-37"><a href="http://comonad.com/reader/category/mathematics/linear-algebra/" title="View all posts filed under Linear Algebra">Linear Algebra</a> (1)
</li>
</ul>
</li>
	<li class="cat-item cat-item-12"><a href="http://comonad.com/reader/category/meta/" title="View all posts filed under Meta">Meta</a> (3)
</li>
	<li class="cat-item cat-item-16"><a href="http://comonad.com/reader/category/monads/" title="View all posts filed under Monads">Monads</a> (27)
</li>
	<li class="cat-item cat-item-31"><a href="http://comonad.com/reader/category/monoids/" title="View all posts filed under Monoids">Monoids</a> (6)
</li>
	<li class="cat-item cat-item-30"><a href="http://comonad.com/reader/category/parsing/" title="View all posts filed under Parsing">Parsing</a> (5)
</li>
	<li class="cat-item cat-item-32"><a href="http://comonad.com/reader/category/scheme/" title="View all posts filed under Scheme">Scheme</a> (1)
</li>
	<li class="cat-item cat-item-24"><a href="http://comonad.com/reader/category/squiggol/" title="View all posts filed under Squiggol">Squiggol</a> (3)
</li>
	<li class="cat-item cat-item-21"><a href="http://comonad.com/reader/category/type-hackery/" title="View all posts filed under Type Hackery">Type Hackery</a> (7)
</li>
	<li class="cat-item cat-item-14"><a href="http://comonad.com/reader/category/type-theory/" title="View all posts filed under Type Theory">Type Theory</a> (5)
</li>
	<li class="cat-item cat-item-1"><a href="http://comonad.com/reader/category/uncategorized/" title="View all posts filed under Uncategorized">Uncategorized</a> (10)
</li>
</ul>
-->
<h2>Tag Cloud</h2>

<h2><label for="s">Search</label></h2>
	<ul>
		<li>
			<form id="searchform" method="get" action="/reader/index.php">
				<div style="text-align:center">
					<p><input type="text" name="s" id="s" size="10" /> <input type="submit" name="submit" value="Search" /></p>
				</div>
			</form>
		</li>
	</ul>
<!--
<h2>Monthly</h2>
	<ul>	<li><a href='http://comonad.com/reader/2012/09/' title='September 2012'>September 2012</a>&nbsp;(1)</li>
	<li><a href='http://comonad.com/reader/2012/08/' title='August 2012'>August 2012</a>&nbsp;(1)</li>
	<li><a href='http://comonad.com/reader/2012/06/' title='June 2012'>June 2012</a>&nbsp;(2)</li>
	<li><a href='http://comonad.com/reader/2012/05/' title='May 2012'>May 2012</a>&nbsp;(1)</li>
	<li><a href='http://comonad.com/reader/2012/04/' title='April 2012'>April 2012</a>&nbsp;(1)</li>
	<li><a href='http://comonad.com/reader/2011/12/' title='December 2011'>December 2011</a>&nbsp;(1)</li>
	<li><a href='http://comonad.com/reader/2011/11/' title='November 2011'>November 2011</a>&nbsp;(2)</li>
	<li><a href='http://comonad.com/reader/2011/10/' title='October 2011'>October 2011</a>&nbsp;(2)</li>
	<li><a href='http://comonad.com/reader/2011/09/' title='September 2011'>September 2011</a>&nbsp;(2)</li>
	<li><a href='http://comonad.com/reader/2011/07/' title='July 2011'>July 2011</a>&nbsp;(1)</li>
	<li><a href='http://comonad.com/reader/2011/06/' title='June 2011'>June 2011</a>&nbsp;(7)</li>
	<li><a href='http://comonad.com/reader/2010/07/' title='July 2010'>July 2010</a>&nbsp;(1)</li>
	<li><a href='http://comonad.com/reader/2010/05/' title='May 2010'>May 2010</a>&nbsp;(4)</li>
	<li><a href='http://comonad.com/reader/2010/04/' title='April 2010'>April 2010</a>&nbsp;(1)</li>
	<li><a href='http://comonad.com/reader/2009/09/' title='September 2009'>September 2009</a>&nbsp;(2)</li>
	<li><a href='http://comonad.com/reader/2009/08/' title='August 2009'>August 2009</a>&nbsp;(3)</li>
	<li><a href='http://comonad.com/reader/2009/07/' title='July 2009'>July 2009</a>&nbsp;(1)</li>
	<li><a href='http://comonad.com/reader/2009/06/' title='June 2009'>June 2009</a>&nbsp;(1)</li>
	<li><a href='http://comonad.com/reader/2009/03/' title='March 2009'>March 2009</a>&nbsp;(1)</li>
	<li><a href='http://comonad.com/reader/2008/12/' title='December 2008'>December 2008</a>&nbsp;(1)</li>
	<li><a href='http://comonad.com/reader/2008/11/' title='November 2008'>November 2008</a>&nbsp;(1)</li>
	<li><a href='http://comonad.com/reader/2008/06/' title='June 2008'>June 2008</a>&nbsp;(3)</li>
	<li><a href='http://comonad.com/reader/2008/05/' title='May 2008'>May 2008</a>&nbsp;(10)</li>
	<li><a href='http://comonad.com/reader/2008/04/' title='April 2008'>April 2008</a>&nbsp;(7)</li>
	<li><a href='http://comonad.com/reader/2008/03/' title='March 2008'>March 2008</a>&nbsp;(2)</li>
	<li><a href='http://comonad.com/reader/2008/01/' title='January 2008'>January 2008</a>&nbsp;(1)</li>
	<li><a href='http://comonad.com/reader/2007/07/' title='July 2007'>July 2007</a>&nbsp;(2)</li>
	<li><a href='http://comonad.com/reader/2007/05/' title='May 2007'>May 2007</a>&nbsp;(1)</li>
	<li><a href='http://comonad.com/reader/2006/11/' title='November 2006'>November 2006</a>&nbsp;(3)</li>
	<li><a href='http://comonad.com/reader/2006/10/' title='October 2006'>October 2006</a>&nbsp;(2)</li>
</ul>
-->
		
<h2>Ads</h2><ul><li><div class="ads" align="center">
<script type="text/javascript"><!--
google_ad_client = "pub-9028661600722510";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
//2006-10-18: Comonad.Reader
google_ad_channel = "6386706477";
google_color_border = "F3F6ED";
google_color_bg = "F3F6ED";
google_color_link = "0E2F0E"; // #0e3f0e 007733
google_color_text = "000000";
google_color_url = "007733";
//--></script><script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script></div>
</li></ul>
<h2>RSS Feeds</h2>
	<ul>
		<li>
			<a title="RSS2 Feed for Posts" href="feed/index.html">Posts</a> | <a title="RSS2 Feed for Comments" href="comments/feed/index.html">Comments</a></li>	
	</ul>	

		<h2>Links</h2>
		<ul><li><a href="http://planet.haskell.org" target="_top">Planet Haskell</a></li>
<li><a href="http://www.haskell.org/hawiki/TheMonadReader" target="_top">The Monad.Reader</a></li>
</ul>
		
		<h2>Meta</h2>
				<ul>
										<li><a href="wp-login.php.html">Log in</a></li>
									</ul>	
	</div>
	
<p id="footer">Design based on <a href="http://www.vanillamist.com" title="Vanilla Mist">www.vanillamist.com</a></p></div>
</div>
</body>
</html>

<!-- Localized -->